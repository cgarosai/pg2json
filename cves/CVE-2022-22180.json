{
    "id": 178514,
    "name": "CVE-2022-22180",
    "cwe": "CWE-754",
    "modified": "2022-02-01T19:17:05",
    "published": "2022-01-19T00:15:09",
    "status": "Analyzed",
    "summary": "An Improper Check for Unusual or Exceptional Conditions vulnerability in the processing of specific IPv6 packets on certain EX Series devices may lead to exhaustion of DMA memory causing a Denial of Service (DoS). Over time, exploitation of this vulnerability may cause traffic to stop being forwarded, or a crash of the fxpc process. An indication of the issue occurring may be observed through the following log messages: Sep 13 17:14:59 hostname : %PFE-3: fpc0 (buf alloc) failed allocating packet buffer Sep 13 17:14:59 hostname : %PFE-7: fpc0 brcm_pkt_buf_alloc:393 (buf alloc) failed allocating packet buffer When Packet DMA heap utilization reaches 99%, the system will become unstable. Packet DMA heap utilization can be monitored using the command: user@junos# request pfe execute target fpc0 timeout 30 command \"show heap\" ID Base Total(b) Free(b) Used(b) % Name -- ---------- ----------- ----------- ----------- --- ----------- 0 213301a8 536870488 387228840 149641648 27 Kernel 1 91800000 8388608 3735120 4653488 55 DMA 2 92000000 75497472 74452192 1045280 1 PKT DMA DESC 3 d330000 335544320 257091400 78452920 23 Bcm_sdk 4 96800000 184549376 2408 184546968 99 Packet DMA <<<< 5 903fffe0 20971504 20971504 0 0 Blob This issue affects: Juniper Networks Junos OS 18.4 versions prior to 18.4R2-S10, 18.4R3-S10 on EX2300 Series, EX2300-MP Series, EX3400 Series; 19.1 versions prior to 19.1R3-S7 on EX2300 Series, EX2300-MP Series, EX3400 Series; 19.2 versions prior to 19.2R1-S8, 19.2R3-S4 on EX2300 Series, EX2300-MP Series, EX3400 Series; 19.3 versions prior to 19.3R3-S5 on EX2300 Series, EX2300-MP Series, EX3400 Series; 19.4 versions prior to 19.4R3-S7 on EX2300 Series, EX2300-MP Series, EX3400 Series; 20.1 versions prior to 20.1R3-S3 on EX2300 Series, EX2300-MP Series, EX3400 Series; 20.2 versions prior to 20.2R3-S3 on EX2300 Series, EX2300-MP Series, EX3400 Series; 20.3 versions prior to 20.3R3-S2 on EX2300 Series, EX2300-MP Series, EX3400 Series; 20.4 versions prior to 20.4R3-S1 on EX2300 Series, EX2300-MP Series, EX3400 Series; 21.1 versions prior to 21.1R2-S2, 21.1R3 on EX2300 Series, EX2300-MP Series, EX3400 Series; 21.2 versions prior to 21.2R1-S2, 21.2R2 on EX2300 Series, EX2300-MP Series, EX3400 Series; 21.3 versions prior to 21.3R1-S1, 21.3R2 on EX2300 Series, EX2300-MP Series, EX3400 Series.",
    "cvss3": {
        "cvss": 7.5,
        "exploitability_score": 3.9,
        "impact_score": 3.6,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    },
    "cvss2": {
        "exploitability_score": 10.0,
        "impact_score": 2.9,
        "cvss": 5.0,
        "vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P"
    },
    "cpes": [
        {
            "id": 134642
        },
        {
            "id": 134643
        },
        {
            "id": 134644
        },
        {
            "id": 220980
        },
        {
            "id": 228363
        },
        {
            "id": 228364
        },
        {
            "id": 228398
        },
        {
            "id": 403101
        },
        {
            "id": 403102
        },
        {
            "id": 485003
        },
        {
            "id": 496153
        },
        {
            "id": 496154
        },
        {
            "id": 496155
        },
        {
            "id": 496156
        },
        {
            "id": 496157
        },
        {
            "id": 496158
        },
        {
            "id": 498806
        },
        {
            "id": 498807
        },
        {
            "id": 498811
        },
        {
            "id": 498815
        },
        {
            "id": 498816
        },
        {
            "id": 498844
        },
        {
            "id": 537124
        },
        {
            "id": 537926
        },
        {
            "id": 537927
        },
        {
            "id": 537928
        },
        {
            "id": 537929
        },
        {
            "id": 537941
        },
        {
            "id": 537942
        },
        {
            "id": 537943
        },
        {
            "id": 537945
        },
        {
            "id": 537946
        },
        {
            "id": 540318
        },
        {
            "id": 540319
        },
        {
            "id": 540320
        },
        {
            "id": 540321
        },
        {
            "id": 540322
        },
        {
            "id": 564053
        },
        {
            "id": 564725
        },
        {
            "id": 564726
        },
        {
            "id": 564727
        },
        {
            "id": 564728
        },
        {
            "id": 590902
        },
        {
            "id": 615515
        },
        {
            "id": 619253
        },
        {
            "id": 619254
        },
        {
            "id": 619256
        },
        {
            "id": 619257
        },
        {
            "id": 619258
        },
        {
            "id": 619259
        },
        {
            "id": 619260
        },
        {
            "id": 619261
        },
        {
            "id": 629407
        },
        {
            "id": 640752
        },
        {
            "id": 640753
        },
        {
            "id": 640777
        },
        {
            "id": 642326
        },
        {
            "id": 642881
        },
        {
            "id": 642882
        },
        {
            "id": 642884
        },
        {
            "id": 642885
        },
        {
            "id": 642887
        },
        {
            "id": 642889
        },
        {
            "id": 642891
        },
        {
            "id": 642892
        },
        {
            "id": 642893
        },
        {
            "id": 690634
        },
        {
            "id": 690714
        },
        {
            "id": 690715
        },
        {
            "id": 690717
        },
        {
            "id": 690721
        },
        {
            "id": 690905
        },
        {
            "id": 690906
        },
        {
            "id": 690953
        },
        {
            "id": 690954
        },
        {
            "id": 690972
        },
        {
            "id": 690974
        },
        {
            "id": 690975
        },
        {
            "id": 690986
        },
        {
            "id": 690987
        },
        {
            "id": 690988
        },
        {
            "id": 690989
        },
        {
            "id": 691000
        },
        {
            "id": 691021
        },
        {
            "id": 691022
        },
        {
            "id": 691518
        },
        {
            "id": 692562
        },
        {
            "id": 746707
        },
        {
            "id": 746708
        },
        {
            "id": 746709
        },
        {
            "id": 746710
        },
        {
            "id": 746711
        },
        {
            "id": 746712
        },
        {
            "id": 746713
        },
        {
            "id": 746714
        },
        {
            "id": 746715
        },
        {
            "id": 746717
        },
        {
            "id": 747817
        },
        {
            "id": 748297
        },
        {
            "id": 748299
        },
        {
            "id": 748824
        },
        {
            "id": 748825
        },
        {
            "id": 760411
        },
        {
            "id": 790158
        },
        {
            "id": 790199
        },
        {
            "id": 799266
        },
        {
            "id": 799271
        },
        {
            "id": 799272
        },
        {
            "id": 799273
        },
        {
            "id": 799274
        },
        {
            "id": 799276
        },
        {
            "id": 799277
        },
        {
            "id": 799279
        },
        {
            "id": 799377
        },
        {
            "id": 799400
        },
        {
            "id": 799401
        },
        {
            "id": 799402
        },
        {
            "id": 799407
        },
        {
            "id": 799409
        },
        {
            "id": 799412
        },
        {
            "id": 799470
        },
        {
            "id": 799471
        },
        {
            "id": 799472
        },
        {
            "id": 830190
        },
        {
            "id": 830774
        },
        {
            "id": 830775
        },
        {
            "id": 830776
        },
        {
            "id": 830777
        },
        {
            "id": 830778
        },
        {
            "id": 830779
        },
        {
            "id": 830780
        },
        {
            "id": 832648
        },
        {
            "id": 833942
        },
        {
            "id": 833943
        },
        {
            "id": 833944
        },
        {
            "id": 833945
        },
        {
            "id": 833946
        },
        {
            "id": 833947
        }
    ]
}