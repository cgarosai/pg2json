{
    "id": 255898,
    "name": "CVE-2024-39477",
    "cwe": "CWE-770",
    "modified": "2024-07-08T15:11:05",
    "published": "2024-07-05T05:15:10",
    "status": "Analyzed",
    "summary": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/hugetlb: do not call vma_add_reservation upon ENOMEM\n\nsysbot reported a splat [1] on __unmap_hugepage_range().  This is because\nvma_needs_reservation() can return -ENOMEM if\nallocate_file_region_entries() fails to allocate the file_region struct\nfor the reservation.\n\nCheck for that and do not call vma_add_reservation() if that is the case,\notherwise region_abort() and region_del() will see that we do not have any\nfile_regions.\n\nIf we detect that vma_needs_reservation() returned -ENOMEM, we clear the\nhugetlb_restore_reserve flag as if this reservation was still consumed, so\nfree_huge_folio() will not increment the resv count.\n\n[1] https://lore.kernel.org/linux-mm/0000000000004096100617c58d54@google.com/T/#ma5983bc1ab18a54910da83416b3f89f3c7ee43aa",
    "cvss3": {
        "cvss": 5.5,
        "exploitability_score": 1.8,
        "impact_score": 3.6,
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
    },
    "cvss2": null,
    "cpes": [
        {
            "id": 1262086
        },
        {
            "id": 1262087
        },
        {
            "id": 1262088
        },
        {
            "id": 1262089
        },
        {
            "id": 1270623
        },
        {
            "id": 1270624
        },
        {
            "id": 1270629
        },
        {
            "id": 1270630
        },
        {
            "id": 1270631
        },
        {
            "id": 1270632
        }
    ]
}