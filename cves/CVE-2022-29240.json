{
    "id": 195526,
    "name": "CVE-2022-29240",
    "cwe": "CWE-908",
    "modified": "2022-09-21T12:17:44",
    "published": "2022-09-15T20:15:11",
    "status": "Analyzed",
    "summary": "Scylla is a real-time big data database that is API-compatible with Apache Cassandra and Amazon DynamoDB. When decompressing CQL frame received from user, Scylla assumes that user-provided uncompressed length is correct. If user provides fake length, that is greater than the real one, part of decompression buffer won't be overwritten, and will be left uninitialized. This can be exploited in several ways, depending on the privileges of the user. 1. The main exploit is that an attacker with access to CQL port, but no user account, can bypass authentication, but only if there are other legitimate clients making connections to the cluster, and they use LZ4. 2. Attacker that already has a user account on the cluster can read parts of uninitialized memory, which can contain things like passwords of other users or fragments of other queries / results, which leads to authorization bypass and sensitive information disclosure. The bug has been patched in the following versions: Scylla Enterprise: 2020.1.14, 2021.1.12, 2022.1.0. Scylla Open Source: 4.6.7, 5.0.3. Users unable to upgrade should make sure none of their drivers connect to cluster using LZ4 compression, and that Scylla CQL port is behind firewall. Additionally make sure no untrusted client can connect to Scylla, by setting up authentication and applying workarounds from previous point (firewall, no lz4 compression).",
    "cvss3": {
        "cvss": 8.1,
        "exploitability_score": 2.2,
        "impact_score": 5.9,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
    },
    "cvss2": null,
    "cpes": [
        {
            "id": 1045269
        },
        {
            "id": 1045270
        },
        {
            "id": 1045271
        },
        {
            "id": 1045272
        },
        {
            "id": 1045273
        },
        {
            "id": 1045274
        },
        {
            "id": 1045275
        },
        {
            "id": 1045276
        },
        {
            "id": 1045277
        },
        {
            "id": 1045278
        },
        {
            "id": 1045279
        },
        {
            "id": 1045280
        },
        {
            "id": 1045281
        },
        {
            "id": 1045282
        },
        {
            "id": 1045283
        },
        {
            "id": 1045284
        },
        {
            "id": 1045285
        },
        {
            "id": 1045286
        },
        {
            "id": 1045287
        },
        {
            "id": 1045288
        },
        {
            "id": 1045289
        },
        {
            "id": 1045290
        },
        {
            "id": 1045291
        },
        {
            "id": 1045292
        },
        {
            "id": 1045293
        },
        {
            "id": 1045294
        },
        {
            "id": 1045295
        },
        {
            "id": 1045296
        },
        {
            "id": 1045297
        },
        {
            "id": 1045298
        },
        {
            "id": 1045299
        },
        {
            "id": 1045300
        },
        {
            "id": 1045301
        },
        {
            "id": 1045302
        },
        {
            "id": 1045303
        },
        {
            "id": 1045304
        },
        {
            "id": 1045305
        },
        {
            "id": 1045306
        },
        {
            "id": 1045307
        },
        {
            "id": 1045308
        },
        {
            "id": 1045309
        },
        {
            "id": 1045310
        },
        {
            "id": 1045311
        },
        {
            "id": 1045312
        },
        {
            "id": 1045313
        },
        {
            "id": 1045314
        },
        {
            "id": 1045315
        },
        {
            "id": 1045316
        },
        {
            "id": 1045317
        },
        {
            "id": 1045318
        },
        {
            "id": 1045319
        },
        {
            "id": 1045320
        },
        {
            "id": 1045321
        },
        {
            "id": 1045322
        },
        {
            "id": 1045323
        },
        {
            "id": 1045324
        },
        {
            "id": 1045325
        },
        {
            "id": 1045326
        },
        {
            "id": 1045327
        },
        {
            "id": 1045328
        },
        {
            "id": 1045329
        },
        {
            "id": 1045330
        },
        {
            "id": 1045331
        },
        {
            "id": 1045332
        },
        {
            "id": 1045333
        },
        {
            "id": 1045334
        },
        {
            "id": 1045335
        },
        {
            "id": 1045336
        },
        {
            "id": 1045337
        },
        {
            "id": 1045338
        },
        {
            "id": 1045339
        },
        {
            "id": 1045340
        },
        {
            "id": 1045341
        },
        {
            "id": 1045342
        },
        {
            "id": 1045343
        },
        {
            "id": 1045344
        },
        {
            "id": 1045345
        },
        {
            "id": 1045346
        },
        {
            "id": 1045347
        },
        {
            "id": 1045348
        },
        {
            "id": 1045349
        },
        {
            "id": 1045350
        },
        {
            "id": 1045351
        },
        {
            "id": 1045352
        },
        {
            "id": 1045353
        },
        {
            "id": 1045354
        },
        {
            "id": 1045355
        },
        {
            "id": 1045356
        },
        {
            "id": 1045357
        },
        {
            "id": 1045358
        },
        {
            "id": 1045359
        },
        {
            "id": 1045360
        },
        {
            "id": 1045361
        },
        {
            "id": 1045362
        },
        {
            "id": 1045363
        },
        {
            "id": 1045364
        },
        {
            "id": 1045365
        },
        {
            "id": 1045366
        },
        {
            "id": 1045367
        },
        {
            "id": 1045368
        },
        {
            "id": 1045369
        },
        {
            "id": 1045370
        },
        {
            "id": 1045371
        },
        {
            "id": 1045372
        },
        {
            "id": 1045373
        },
        {
            "id": 1045374
        },
        {
            "id": 1045375
        },
        {
            "id": 1045376
        },
        {
            "id": 1045377
        },
        {
            "id": 1045378
        },
        {
            "id": 1045379
        },
        {
            "id": 1045380
        },
        {
            "id": 1045381
        },
        {
            "id": 1045382
        },
        {
            "id": 1045383
        },
        {
            "id": 1045384
        },
        {
            "id": 1045385
        },
        {
            "id": 1045386
        },
        {
            "id": 1045387
        },
        {
            "id": 1045388
        },
        {
            "id": 1045389
        },
        {
            "id": 1045390
        },
        {
            "id": 1045391
        },
        {
            "id": 1045392
        },
        {
            "id": 1045393
        },
        {
            "id": 1045394
        },
        {
            "id": 1045395
        },
        {
            "id": 1045396
        },
        {
            "id": 1045397
        },
        {
            "id": 1045398
        },
        {
            "id": 1045399
        },
        {
            "id": 1045400
        },
        {
            "id": 1045401
        },
        {
            "id": 1045402
        },
        {
            "id": 1045403
        },
        {
            "id": 1045404
        },
        {
            "id": 1045405
        },
        {
            "id": 1045406
        },
        {
            "id": 1045412
        },
        {
            "id": 1045413
        },
        {
            "id": 1045414
        },
        {
            "id": 1045415
        },
        {
            "id": 1045416
        },
        {
            "id": 1045417
        },
        {
            "id": 1045426
        },
        {
            "id": 1045427
        },
        {
            "id": 1045444
        },
        {
            "id": 1045445
        },
        {
            "id": 1045446
        },
        {
            "id": 1045447
        },
        {
            "id": 1045448
        },
        {
            "id": 1045449
        },
        {
            "id": 1045450
        },
        {
            "id": 1045451
        },
        {
            "id": 1045452
        },
        {
            "id": 1045453
        },
        {
            "id": 1045454
        },
        {
            "id": 1045455
        },
        {
            "id": 1045456
        },
        {
            "id": 1045457
        },
        {
            "id": 1045458
        },
        {
            "id": 1045459
        },
        {
            "id": 1045460
        },
        {
            "id": 1045461
        },
        {
            "id": 1045462
        },
        {
            "id": 1045463
        },
        {
            "id": 1045464
        },
        {
            "id": 1045465
        },
        {
            "id": 1045466
        },
        {
            "id": 1045467
        },
        {
            "id": 1045468
        },
        {
            "id": 1045469
        },
        {
            "id": 1045470
        },
        {
            "id": 1045471
        },
        {
            "id": 1045472
        },
        {
            "id": 1045473
        },
        {
            "id": 1045474
        },
        {
            "id": 1045475
        },
        {
            "id": 1045476
        },
        {
            "id": 1045477
        },
        {
            "id": 1045478
        },
        {
            "id": 1045479
        },
        {
            "id": 1045480
        },
        {
            "id": 1045481
        },
        {
            "id": 1045482
        },
        {
            "id": 1045483
        },
        {
            "id": 1045484
        },
        {
            "id": 1045485
        },
        {
            "id": 1045486
        },
        {
            "id": 1045487
        },
        {
            "id": 1045488
        },
        {
            "id": 1045489
        },
        {
            "id": 1045490
        },
        {
            "id": 1045491
        },
        {
            "id": 1045492
        },
        {
            "id": 1045493
        },
        {
            "id": 1045494
        },
        {
            "id": 1045495
        },
        {
            "id": 1045496
        },
        {
            "id": 1045497
        },
        {
            "id": 1045498
        },
        {
            "id": 1045499
        },
        {
            "id": 1045500
        },
        {
            "id": 1045501
        },
        {
            "id": 1045502
        },
        {
            "id": 1045503
        },
        {
            "id": 1045504
        },
        {
            "id": 1045505
        },
        {
            "id": 1045506
        },
        {
            "id": 1045507
        },
        {
            "id": 1045508
        },
        {
            "id": 1045509
        },
        {
            "id": 1045510
        },
        {
            "id": 1045511
        },
        {
            "id": 1045512
        },
        {
            "id": 1045513
        },
        {
            "id": 1045514
        },
        {
            "id": 1045515
        },
        {
            "id": 1045516
        },
        {
            "id": 1045517
        },
        {
            "id": 1045518
        },
        {
            "id": 1045519
        },
        {
            "id": 1045520
        },
        {
            "id": 1045521
        },
        {
            "id": 1045522
        },
        {
            "id": 1045523
        },
        {
            "id": 1045524
        },
        {
            "id": 1045525
        },
        {
            "id": 1045526
        },
        {
            "id": 1045527
        },
        {
            "id": 1045528
        },
        {
            "id": 1045529
        },
        {
            "id": 1045530
        },
        {
            "id": 1045531
        },
        {
            "id": 1045532
        },
        {
            "id": 1045533
        },
        {
            "id": 1045534
        },
        {
            "id": 1045535
        },
        {
            "id": 1045536
        },
        {
            "id": 1045537
        },
        {
            "id": 1045538
        },
        {
            "id": 1045539
        },
        {
            "id": 1045540
        },
        {
            "id": 1045541
        },
        {
            "id": 1045542
        },
        {
            "id": 1045543
        },
        {
            "id": 1045544
        },
        {
            "id": 1045545
        },
        {
            "id": 1045546
        },
        {
            "id": 1045547
        },
        {
            "id": 1045548
        },
        {
            "id": 1045549
        },
        {
            "id": 1045550
        },
        {
            "id": 1045551
        },
        {
            "id": 1045552
        },
        {
            "id": 1045553
        },
        {
            "id": 1045554
        },
        {
            "id": 1045555
        },
        {
            "id": 1047214
        },
        {
            "id": 1047215
        },
        {
            "id": 1047216
        },
        {
            "id": 1047217
        },
        {
            "id": 1047218
        },
        {
            "id": 1047219
        },
        {
            "id": 1047220
        },
        {
            "id": 1047221
        },
        {
            "id": 1047222
        },
        {
            "id": 1047223
        },
        {
            "id": 1047224
        },
        {
            "id": 1047225
        },
        {
            "id": 1047226
        },
        {
            "id": 1047227
        },
        {
            "id": 1047228
        },
        {
            "id": 1047229
        },
        {
            "id": 1047230
        },
        {
            "id": 1047231
        },
        {
            "id": 1047232
        },
        {
            "id": 1047233
        },
        {
            "id": 1047234
        },
        {
            "id": 1047235
        },
        {
            "id": 1047236
        },
        {
            "id": 1047237
        },
        {
            "id": 1047238
        },
        {
            "id": 1047239
        },
        {
            "id": 1047240
        },
        {
            "id": 1047241
        },
        {
            "id": 1047242
        },
        {
            "id": 1047243
        },
        {
            "id": 1047244
        },
        {
            "id": 1047245
        },
        {
            "id": 1047246
        },
        {
            "id": 1047247
        },
        {
            "id": 1047248
        },
        {
            "id": 1047249
        },
        {
            "id": 1047250
        },
        {
            "id": 1047251
        },
        {
            "id": 1047252
        },
        {
            "id": 1047253
        },
        {
            "id": 1047254
        },
        {
            "id": 1047255
        },
        {
            "id": 1047256
        },
        {
            "id": 1047257
        },
        {
            "id": 1047258
        },
        {
            "id": 1047259
        },
        {
            "id": 1047260
        },
        {
            "id": 1047261
        },
        {
            "id": 1047262
        },
        {
            "id": 1047263
        },
        {
            "id": 1047264
        },
        {
            "id": 1047265
        },
        {
            "id": 1047266
        },
        {
            "id": 1047267
        },
        {
            "id": 1047268
        },
        {
            "id": 1047269
        },
        {
            "id": 1047270
        },
        {
            "id": 1047271
        }
    ]
}