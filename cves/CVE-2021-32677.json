{
    "id": 164315,
    "name": "CVE-2021-32677",
    "cwe": "CWE-352",
    "modified": "2024-02-12T19:04:02",
    "published": "2021-06-09T16:15:08",
    "status": "Modified",
    "summary": "FastAPI is a web framework for building APIs with Python 3.6+ based on standard Python type hints. FastAPI versions lower than 0.65.2 that used cookies for authentication in path operations that received JSON payloads sent by browsers were vulnerable to a Cross-Site Request Forgery (CSRF) attack. In versions lower than 0.65.2, FastAPI would try to read the request payload as JSON even if the content-type header sent was not set to application/json or a compatible JSON media type (e.g. application/geo+json). A request with a content type of text/plain containing JSON data would be accepted and the JSON data would be extracted. Requests with content type text/plain are exempt from CORS preflights, for being considered Simple requests. The browser will execute them right away including cookies, and the text content could be a JSON string that would be parsed and accepted by the FastAPI application. This is fixed in FastAPI 0.65.2. The request data is now parsed as JSON only if the content-type header is application/json or another JSON compatible media type like application/geo+json. It's best to upgrade to the latest FastAPI, but if updating is not possible then a middleware or a dependency that checks the content-type header and aborts the request if it is not application/json or another JSON compatible content type can act as a mitigating workaround.",
    "cvss3": {
        "cvss": 8.1,
        "exploitability_score": 2.8,
        "impact_score": 5.2,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N"
    },
    "cvss2": {
        "exploitability_score": 8.6,
        "impact_score": 4.9,
        "cvss": 5.8,
        "vector": "AV:N/AC:M/Au:N/C:P/I:P/A:N"
    },
    "cpes": [
        {
            "id": 622632
        },
        {
            "id": 1258825
        },
        {
            "id": 1258876
        },
        {
            "id": 1258877
        },
        {
            "id": 1258878
        },
        {
            "id": 1258879
        },
        {
            "id": 1258880
        },
        {
            "id": 1258881
        },
        {
            "id": 1258882
        },
        {
            "id": 1258883
        },
        {
            "id": 1258884
        },
        {
            "id": 1258885
        },
        {
            "id": 1258886
        },
        {
            "id": 1258887
        },
        {
            "id": 1258888
        },
        {
            "id": 1258889
        },
        {
            "id": 1258890
        },
        {
            "id": 1258891
        },
        {
            "id": 1258892
        },
        {
            "id": 1258893
        },
        {
            "id": 1258894
        },
        {
            "id": 1258895
        },
        {
            "id": 1258896
        },
        {
            "id": 1258897
        },
        {
            "id": 1258898
        },
        {
            "id": 1258899
        },
        {
            "id": 1258900
        },
        {
            "id": 1258901
        },
        {
            "id": 1258902
        },
        {
            "id": 1258903
        },
        {
            "id": 1258904
        },
        {
            "id": 1258905
        },
        {
            "id": 1258906
        },
        {
            "id": 1258907
        },
        {
            "id": 1258908
        },
        {
            "id": 1258909
        },
        {
            "id": 1258910
        },
        {
            "id": 1258911
        },
        {
            "id": 1258912
        },
        {
            "id": 1258913
        },
        {
            "id": 1258914
        },
        {
            "id": 1258915
        },
        {
            "id": 1258916
        },
        {
            "id": 1258917
        },
        {
            "id": 1258918
        },
        {
            "id": 1258919
        },
        {
            "id": 1258920
        },
        {
            "id": 1258921
        },
        {
            "id": 1258922
        },
        {
            "id": 1258923
        },
        {
            "id": 1258924
        },
        {
            "id": 1258925
        },
        {
            "id": 1258926
        },
        {
            "id": 1258927
        },
        {
            "id": 1258928
        },
        {
            "id": 1258929
        },
        {
            "id": 1258930
        },
        {
            "id": 1258931
        },
        {
            "id": 1258932
        },
        {
            "id": 1258933
        },
        {
            "id": 1258934
        },
        {
            "id": 1258935
        },
        {
            "id": 1258936
        },
        {
            "id": 1258937
        },
        {
            "id": 1258938
        },
        {
            "id": 1258939
        },
        {
            "id": 1258940
        },
        {
            "id": 1258941
        },
        {
            "id": 1258942
        },
        {
            "id": 1258943
        },
        {
            "id": 1258944
        },
        {
            "id": 1258945
        },
        {
            "id": 1258946
        },
        {
            "id": 1258947
        },
        {
            "id": 1258948
        },
        {
            "id": 1258949
        },
        {
            "id": 1258950
        },
        {
            "id": 1258951
        },
        {
            "id": 1258952
        },
        {
            "id": 1258953
        },
        {
            "id": 1258954
        },
        {
            "id": 1258955
        },
        {
            "id": 1258956
        },
        {
            "id": 1258957
        },
        {
            "id": 1258958
        },
        {
            "id": 1258959
        },
        {
            "id": 1258960
        },
        {
            "id": 1258961
        },
        {
            "id": 1258962
        },
        {
            "id": 1258963
        },
        {
            "id": 1258964
        },
        {
            "id": 1258965
        },
        {
            "id": 1258966
        },
        {
            "id": 1258967
        },
        {
            "id": 1258968
        },
        {
            "id": 1258969
        },
        {
            "id": 1258970
        },
        {
            "id": 1258971
        },
        {
            "id": 1258972
        },
        {
            "id": 1258973
        },
        {
            "id": 1258974
        },
        {
            "id": 1258975
        },
        {
            "id": 1258976
        },
        {
            "id": 1258977
        },
        {
            "id": 1258978
        },
        {
            "id": 1258979
        },
        {
            "id": 1258980
        },
        {
            "id": 1258981
        }
    ]
}