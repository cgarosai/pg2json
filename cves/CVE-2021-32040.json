{
    "id": 184333,
    "name": "CVE-2021-32040",
    "cwe": "CWE-787",
    "modified": "2024-02-23T15:15:46",
    "published": "2022-04-12T13:15:07",
    "status": "Modified",
    "summary": "It may be possible to have an extremely long aggregation pipeline in conjunction with a specific stage/operator and cause a stack overflow due to the size of the stack frames used by that stage. If an attacker could cause such an aggregation to occur, they could maliciously crash MongoDB in a DoS attack. This vulnerability affects MongoDB Server v4.4 versions prior to and including 4.4.28, MongoDB Server v5.0 versions prior to 5.0.4 and MongoDB Server v4.2 versions prior to 4.2.16.\n\nWorkaround:\u00a0>= v4.2.16 users and all v4.4 users can add the --setParameter internalPipelineLengthLimit=50 instead of the default 1000 to mongod at startup to prevent a crash.\n\n",
    "cvss3": {
        "cvss": 7.5,
        "exploitability_score": 3.9,
        "impact_score": 3.6,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    },
    "cvss2": {
        "exploitability_score": 10.0,
        "impact_score": 2.9,
        "cvss": 5.0,
        "vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P"
    },
    "cpes": [
        {
            "id": 549979
        },
        {
            "id": 549980
        },
        {
            "id": 549981
        },
        {
            "id": 549982
        },
        {
            "id": 597610
        },
        {
            "id": 597611
        },
        {
            "id": 597612
        },
        {
            "id": 597613
        },
        {
            "id": 597614
        },
        {
            "id": 597615
        },
        {
            "id": 597616
        },
        {
            "id": 597617
        },
        {
            "id": 597618
        },
        {
            "id": 597619
        },
        {
            "id": 597620
        },
        {
            "id": 597621
        },
        {
            "id": 597622
        },
        {
            "id": 597623
        },
        {
            "id": 597624
        },
        {
            "id": 597625
        },
        {
            "id": 597626
        },
        {
            "id": 597627
        },
        {
            "id": 597628
        },
        {
            "id": 597629
        },
        {
            "id": 597630
        },
        {
            "id": 597631
        },
        {
            "id": 597632
        },
        {
            "id": 597633
        },
        {
            "id": 597634
        },
        {
            "id": 597635
        },
        {
            "id": 597636
        },
        {
            "id": 597637
        },
        {
            "id": 627451
        },
        {
            "id": 627452
        },
        {
            "id": 671270
        },
        {
            "id": 671271
        },
        {
            "id": 671272
        },
        {
            "id": 810005
        },
        {
            "id": 810006
        },
        {
            "id": 810007
        },
        {
            "id": 810008
        },
        {
            "id": 810009
        },
        {
            "id": 810010
        },
        {
            "id": 810011
        },
        {
            "id": 810012
        },
        {
            "id": 810013
        },
        {
            "id": 810014
        },
        {
            "id": 810015
        },
        {
            "id": 810016
        },
        {
            "id": 810017
        },
        {
            "id": 810018
        },
        {
            "id": 810019
        },
        {
            "id": 810021
        },
        {
            "id": 810022
        },
        {
            "id": 810023
        },
        {
            "id": 810025
        },
        {
            "id": 810026
        },
        {
            "id": 819982
        },
        {
            "id": 819983
        },
        {
            "id": 819984
        },
        {
            "id": 819985
        },
        {
            "id": 819986
        },
        {
            "id": 819987
        },
        {
            "id": 819988
        },
        {
            "id": 819989
        },
        {
            "id": 829417
        },
        {
            "id": 829418
        },
        {
            "id": 829419
        },
        {
            "id": 829420
        },
        {
            "id": 829421
        },
        {
            "id": 829424
        },
        {
            "id": 829425
        },
        {
            "id": 829426
        },
        {
            "id": 829427
        },
        {
            "id": 829428
        },
        {
            "id": 829429
        },
        {
            "id": 829430
        },
        {
            "id": 829431
        },
        {
            "id": 829432
        }
    ]
}