{
    "id": 224478,
    "name": "CVE-2023-40029",
    "cwe": "CWE-532",
    "modified": "2023-10-27T12:31:09",
    "published": "2023-09-07T21:15:09",
    "status": "Analyzed",
    "summary": "Argo CD is a declarative continuous deployment for Kubernetes. Argo CD Cluster secrets might be managed declaratively using Argo CD / kubectl apply. As a result, the full secret body is stored in`kubectl.kubernetes.io/last-applied-configuration` annotation. pull request #7139 introduced the ability to manage cluster labels and annotations. Since clusters are stored as secrets it also exposes the `kubectl.kubernetes.io/last-applied-configuration` annotation which includes full secret body. In order to view the cluster annotations via the Argo CD API, the user must have `clusters, get` RBAC access. **Note:** In many cases, cluster secrets do not contain any actually-secret information. But sometimes, as in bearer-token auth, the contents might be very sensitive. The bug has been patched in versions 2.8.3, 2.7.14, and 2.6.15. Users are advised to upgrade. Users unable to upgrade should update/deploy cluster secret with `server-side-apply` flag which does not use or rely on `kubectl.kubernetes.io/last-applied-configuration` annotation. Note: annotation for existing secrets will require manual removal.\n\n",
    "cvss3": {
        "cvss": 9.6,
        "exploitability_score": 3.1,
        "impact_score": 5.8,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N"
    },
    "cvss2": null,
    "cpes": [
        {
            "id": 1024346
        },
        {
            "id": 1024347
        },
        {
            "id": 1024348
        },
        {
            "id": 1024349
        },
        {
            "id": 1024350
        },
        {
            "id": 1024351
        },
        {
            "id": 1024352
        },
        {
            "id": 1024353
        },
        {
            "id": 1024374
        },
        {
            "id": 1024375
        },
        {
            "id": 1024376
        },
        {
            "id": 1024377
        },
        {
            "id": 1024378
        },
        {
            "id": 1024379
        },
        {
            "id": 1024380
        },
        {
            "id": 1024381
        },
        {
            "id": 1024382
        },
        {
            "id": 1024383
        },
        {
            "id": 1024384
        },
        {
            "id": 1024385
        },
        {
            "id": 1024386
        },
        {
            "id": 1024387
        },
        {
            "id": 1024388
        },
        {
            "id": 1024389
        },
        {
            "id": 1024390
        },
        {
            "id": 1024391
        },
        {
            "id": 1024392
        },
        {
            "id": 1024393
        },
        {
            "id": 1024394
        },
        {
            "id": 1024395
        },
        {
            "id": 1024396
        },
        {
            "id": 1024397
        },
        {
            "id": 1024398
        },
        {
            "id": 1024399
        },
        {
            "id": 1024400
        },
        {
            "id": 1024401
        },
        {
            "id": 1024402
        },
        {
            "id": 1024403
        },
        {
            "id": 1024404
        },
        {
            "id": 1024405
        },
        {
            "id": 1024406
        },
        {
            "id": 1024407
        },
        {
            "id": 1024408
        },
        {
            "id": 1024409
        },
        {
            "id": 1024410
        },
        {
            "id": 1024411
        },
        {
            "id": 1024412
        },
        {
            "id": 1024413
        },
        {
            "id": 1024414
        },
        {
            "id": 1024415
        },
        {
            "id": 1024416
        },
        {
            "id": 1024417
        },
        {
            "id": 1024418
        },
        {
            "id": 1024419
        },
        {
            "id": 1024420
        },
        {
            "id": 1024421
        },
        {
            "id": 1024422
        },
        {
            "id": 1024423
        },
        {
            "id": 1024424
        },
        {
            "id": 1024425
        },
        {
            "id": 1024426
        },
        {
            "id": 1024427
        },
        {
            "id": 1024428
        },
        {
            "id": 1024429
        },
        {
            "id": 1024430
        },
        {
            "id": 1024431
        },
        {
            "id": 1024432
        },
        {
            "id": 1024433
        },
        {
            "id": 1024434
        },
        {
            "id": 1024435
        },
        {
            "id": 1024436
        },
        {
            "id": 1024437
        },
        {
            "id": 1024438
        },
        {
            "id": 1024439
        },
        {
            "id": 1024440
        },
        {
            "id": 1024441
        },
        {
            "id": 1024442
        },
        {
            "id": 1024443
        },
        {
            "id": 1024444
        },
        {
            "id": 1024445
        },
        {
            "id": 1024446
        },
        {
            "id": 1024447
        },
        {
            "id": 1024448
        },
        {
            "id": 1024449
        },
        {
            "id": 1024450
        },
        {
            "id": 1024451
        },
        {
            "id": 1024452
        },
        {
            "id": 1024453
        },
        {
            "id": 1024454
        },
        {
            "id": 1024455
        },
        {
            "id": 1024456
        },
        {
            "id": 1156600
        },
        {
            "id": 1156602
        },
        {
            "id": 1156603
        },
        {
            "id": 1156604
        },
        {
            "id": 1156605
        },
        {
            "id": 1156606
        },
        {
            "id": 1156607
        },
        {
            "id": 1156608
        },
        {
            "id": 1156609
        },
        {
            "id": 1156610
        },
        {
            "id": 1156611
        },
        {
            "id": 1156612
        },
        {
            "id": 1156613
        },
        {
            "id": 1156614
        },
        {
            "id": 1156615
        },
        {
            "id": 1156616
        },
        {
            "id": 1156617
        },
        {
            "id": 1156618
        },
        {
            "id": 1156619
        },
        {
            "id": 1156620
        },
        {
            "id": 1156621
        },
        {
            "id": 1156622
        },
        {
            "id": 1156623
        },
        {
            "id": 1156624
        },
        {
            "id": 1156625
        },
        {
            "id": 1156626
        },
        {
            "id": 1156627
        },
        {
            "id": 1156628
        },
        {
            "id": 1156629
        },
        {
            "id": 1156630
        },
        {
            "id": 1156631
        },
        {
            "id": 1156632
        },
        {
            "id": 1156633
        },
        {
            "id": 1156634
        },
        {
            "id": 1156635
        },
        {
            "id": 1156636
        },
        {
            "id": 1156637
        },
        {
            "id": 1156638
        },
        {
            "id": 1156639
        }
    ]
}