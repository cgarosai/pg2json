{
    "id": 247345,
    "name": "CVE-2024-27022",
    "cwe": "CWE-908",
    "modified": "2024-06-21T12:15:11",
    "published": "2024-05-01T04:15:21",
    "status": "Modified",
    "summary": "In the Linux kernel, the following vulnerability has been resolved:\n\nfork: defer linking file vma until vma is fully initialized\n\nThorvald reported a WARNING [1]. And the root cause is below race:\n\n CPU 1\t\t\t\t\tCPU 2\n fork\t\t\t\t\thugetlbfs_fallocate\n  dup_mmap\t\t\t\t hugetlbfs_punch_hole\n   i_mmap_lock_write(mapping);\n   vma_interval_tree_insert_after -- Child vma is visible through i_mmap tree.\n   i_mmap_unlock_write(mapping);\n   hugetlb_dup_vma_private -- Clear vma_lock outside i_mmap_rwsem!\n\t\t\t\t\t i_mmap_lock_write(mapping);\n   \t\t\t\t\t hugetlb_vmdelete_list\n\t\t\t\t\t  vma_interval_tree_foreach\n\t\t\t\t\t   hugetlb_vma_trylock_write -- Vma_lock is cleared.\n   tmp->vm_ops->open -- Alloc new vma_lock outside i_mmap_rwsem!\n\t\t\t\t\t   hugetlb_vma_unlock_write -- Vma_lock is assigned!!!\n\t\t\t\t\t i_mmap_unlock_write(mapping);\n\nhugetlb_dup_vma_private() and hugetlb_vm_op_open() are called outside\ni_mmap_rwsem lock while vma lock can be used in the same time.  Fix this\nby deferring linking file vma until vma is fully initialized.  Those vmas\nshould be initialized first before they can be used.",
    "cvss3": {
        "cvss": 7.8,
        "exploitability_score": 1.8,
        "impact_score": 5.9,
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
    },
    "cvss2": null,
    "cpes": [
        {
            "id": 961481
        },
        {
            "id": 961532
        },
        {
            "id": 981148
        },
        {
            "id": 981149
        },
        {
            "id": 981150
        },
        {
            "id": 981151
        },
        {
            "id": 981152
        },
        {
            "id": 981153
        },
        {
            "id": 981154
        },
        {
            "id": 1010139
        },
        {
            "id": 1018276
        },
        {
            "id": 1018277
        },
        {
            "id": 1018278
        },
        {
            "id": 1018279
        },
        {
            "id": 1018280
        },
        {
            "id": 1018281
        },
        {
            "id": 1018282
        },
        {
            "id": 1023085
        },
        {
            "id": 1023086
        },
        {
            "id": 1025374
        },
        {
            "id": 1025375
        },
        {
            "id": 1030502
        },
        {
            "id": 1030503
        },
        {
            "id": 1030504
        },
        {
            "id": 1030505
        },
        {
            "id": 1030506
        },
        {
            "id": 1031511
        },
        {
            "id": 1031512
        },
        {
            "id": 1051450
        },
        {
            "id": 1052819
        },
        {
            "id": 1054836
        },
        {
            "id": 1054837
        },
        {
            "id": 1054838
        },
        {
            "id": 1054839
        },
        {
            "id": 1054840
        },
        {
            "id": 1054841
        },
        {
            "id": 1054842
        },
        {
            "id": 1054843
        },
        {
            "id": 1059336
        },
        {
            "id": 1059337
        },
        {
            "id": 1059338
        },
        {
            "id": 1059373
        },
        {
            "id": 1059374
        },
        {
            "id": 1059375
        },
        {
            "id": 1059376
        },
        {
            "id": 1072111
        },
        {
            "id": 1078375
        },
        {
            "id": 1080371
        },
        {
            "id": 1080372
        },
        {
            "id": 1080514
        },
        {
            "id": 1080515
        },
        {
            "id": 1080516
        },
        {
            "id": 1080517
        },
        {
            "id": 1080518
        },
        {
            "id": 1096975
        },
        {
            "id": 1096976
        },
        {
            "id": 1096977
        },
        {
            "id": 1096978
        },
        {
            "id": 1096979
        },
        {
            "id": 1096980
        },
        {
            "id": 1096981
        },
        {
            "id": 1096982
        },
        {
            "id": 1096983
        },
        {
            "id": 1096984
        },
        {
            "id": 1096985
        },
        {
            "id": 1096986
        },
        {
            "id": 1096987
        },
        {
            "id": 1096988
        },
        {
            "id": 1096989
        },
        {
            "id": 1096990
        },
        {
            "id": 1096991
        },
        {
            "id": 1096992
        },
        {
            "id": 1096993
        },
        {
            "id": 1096994
        },
        {
            "id": 1096995
        },
        {
            "id": 1096996
        },
        {
            "id": 1096997
        },
        {
            "id": 1096998
        },
        {
            "id": 1096999
        },
        {
            "id": 1097000
        },
        {
            "id": 1097001
        },
        {
            "id": 1097002
        },
        {
            "id": 1097003
        },
        {
            "id": 1097004
        },
        {
            "id": 1097005
        },
        {
            "id": 1108390
        },
        {
            "id": 1116576
        },
        {
            "id": 1116577
        },
        {
            "id": 1116578
        },
        {
            "id": 1116579
        },
        {
            "id": 1116580
        },
        {
            "id": 1121277
        },
        {
            "id": 1121584
        },
        {
            "id": 1121585
        },
        {
            "id": 1121586
        },
        {
            "id": 1121807
        },
        {
            "id": 1121808
        },
        {
            "id": 1121809
        },
        {
            "id": 1121810
        },
        {
            "id": 1162660
        },
        {
            "id": 1162661
        },
        {
            "id": 1162662
        },
        {
            "id": 1162663
        },
        {
            "id": 1162664
        },
        {
            "id": 1162665
        },
        {
            "id": 1162666
        },
        {
            "id": 1162667
        },
        {
            "id": 1162668
        },
        {
            "id": 1162669
        },
        {
            "id": 1162670
        },
        {
            "id": 1162671
        },
        {
            "id": 1162672
        },
        {
            "id": 1162673
        },
        {
            "id": 1162674
        },
        {
            "id": 1162675
        },
        {
            "id": 1162676
        },
        {
            "id": 1162677
        },
        {
            "id": 1162678
        },
        {
            "id": 1162679
        },
        {
            "id": 1162680
        },
        {
            "id": 1162681
        },
        {
            "id": 1162682
        },
        {
            "id": 1162683
        },
        {
            "id": 1162684
        },
        {
            "id": 1162685
        },
        {
            "id": 1162686
        },
        {
            "id": 1162687
        },
        {
            "id": 1162688
        },
        {
            "id": 1162689
        },
        {
            "id": 1162690
        },
        {
            "id": 1170827
        },
        {
            "id": 1170828
        },
        {
            "id": 1170829
        },
        {
            "id": 1170830
        },
        {
            "id": 1183995
        },
        {
            "id": 1183996
        },
        {
            "id": 1183997
        },
        {
            "id": 1183998
        },
        {
            "id": 1184006
        },
        {
            "id": 1198317
        },
        {
            "id": 1199385
        },
        {
            "id": 1199386
        },
        {
            "id": 1199387
        },
        {
            "id": 1199388
        },
        {
            "id": 1199389
        },
        {
            "id": 1199390
        },
        {
            "id": 1199391
        },
        {
            "id": 1217932
        },
        {
            "id": 1217933
        },
        {
            "id": 1217934
        },
        {
            "id": 1217935
        },
        {
            "id": 1217936
        },
        {
            "id": 1217937
        },
        {
            "id": 1217938
        },
        {
            "id": 1217939
        },
        {
            "id": 1217940
        },
        {
            "id": 1217941
        },
        {
            "id": 1217942
        },
        {
            "id": 1217943
        },
        {
            "id": 1217944
        },
        {
            "id": 1217945
        },
        {
            "id": 1217946
        },
        {
            "id": 1217947
        },
        {
            "id": 1226777
        },
        {
            "id": 1226778
        },
        {
            "id": 1226779
        },
        {
            "id": 1226780
        },
        {
            "id": 1226781
        },
        {
            "id": 1226782
        },
        {
            "id": 1226783
        },
        {
            "id": 1226784
        },
        {
            "id": 1226785
        },
        {
            "id": 1226786
        },
        {
            "id": 1226787
        },
        {
            "id": 1226788
        },
        {
            "id": 1226789
        },
        {
            "id": 1226790
        },
        {
            "id": 1226791
        },
        {
            "id": 1226792
        },
        {
            "id": 1226793
        },
        {
            "id": 1226794
        },
        {
            "id": 1226795
        },
        {
            "id": 1226796
        },
        {
            "id": 1226797
        },
        {
            "id": 1226798
        },
        {
            "id": 1226799
        },
        {
            "id": 1226800
        },
        {
            "id": 1226801
        },
        {
            "id": 1226802
        },
        {
            "id": 1226803
        },
        {
            "id": 1226804
        },
        {
            "id": 1226805
        },
        {
            "id": 1226806
        },
        {
            "id": 1226807
        },
        {
            "id": 1226808
        },
        {
            "id": 1248979
        },
        {
            "id": 1248980
        },
        {
            "id": 1248981
        },
        {
            "id": 1248982
        },
        {
            "id": 1248983
        },
        {
            "id": 1248984
        },
        {
            "id": 1248985
        },
        {
            "id": 1248986
        },
        {
            "id": 1248987
        },
        {
            "id": 1248988
        },
        {
            "id": 1248989
        },
        {
            "id": 1248990
        },
        {
            "id": 1262083
        },
        {
            "id": 1262084
        },
        {
            "id": 1262086
        },
        {
            "id": 1262087
        },
        {
            "id": 1262088
        },
        {
            "id": 1262089
        },
        {
            "id": 1262090
        },
        {
            "id": 1262091
        },
        {
            "id": 1266367
        },
        {
            "id": 1266368
        },
        {
            "id": 1266369
        },
        {
            "id": 1266370
        },
        {
            "id": 1266371
        },
        {
            "id": 1266372
        },
        {
            "id": 1266373
        },
        {
            "id": 1266374
        },
        {
            "id": 1266375
        },
        {
            "id": 1266376
        },
        {
            "id": 1266377
        },
        {
            "id": 1266378
        },
        {
            "id": 1266379
        },
        {
            "id": 1266380
        },
        {
            "id": 1266381
        },
        {
            "id": 1266382
        },
        {
            "id": 1266383
        },
        {
            "id": 1266384
        },
        {
            "id": 1266385
        },
        {
            "id": 1266386
        },
        {
            "id": 1266387
        },
        {
            "id": 1266388
        },
        {
            "id": 1266389
        },
        {
            "id": 1266390
        },
        {
            "id": 1266391
        },
        {
            "id": 1266392
        },
        {
            "id": 1270644
        }
    ]
}