{
    "id": 218488,
    "name": "CVE-2023-35165",
    "cwe": "CWE-863",
    "modified": "2023-07-06T13:37:52",
    "published": "2023-06-23T19:15:09",
    "status": "Analyzed",
    "summary": "AWS Cloud Development Kit (AWS CDK) is an open-source software development framework to define cloud infrastructure in code and provision it through AWS CloudFormation. In the packages `aws-cdk-lib` 2.0.0 until 2.80.0 and `@aws-cdk/aws-eks` 1.57.0 until 1.202.0, `eks.Cluster` and `eks.FargateCluster` constructs create two roles, `CreationRole` and `default MastersRole`, that have an overly permissive trust policy. \n \nThe first, referred to as the `CreationRole`, is used by lambda handlers to create the cluster and deploy Kubernetes resources (e.g `KubernetesManifest`, `HelmChart`, ...) onto it. Users with CDK version higher or equal to 1.62.0 (including v2 users) may be affected.\n \nThe second, referred to as the `default MastersRole`, is provisioned only if the `mastersRole` property isn't provided and has permissions to execute `kubectl` commands on the cluster. Users with CDK version higher or equal to 1.57.0 (including v2 users) may be affected.\n\nThe issue has been fixed in `@aws-cdk/aws-eks` v1.202.0 and `aws-cdk-lib` v2.80.0. These versions no longer use the account root principal. Instead, they restrict the trust policy to the specific roles of lambda handlers that need it. There is no workaround available for CreationRole. To avoid creating the `default MastersRole`, use the `mastersRole` property to explicitly provide a role.",
    "cvss3": {
        "cvss": 8.8,
        "exploitability_score": 2.8,
        "impact_score": 5.9,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
    },
    "cvss2": null,
    "cpes": [
        {
            "id": 1115334
        },
        {
            "id": 1115335
        },
        {
            "id": 1115336
        },
        {
            "id": 1115337
        },
        {
            "id": 1115338
        },
        {
            "id": 1115339
        },
        {
            "id": 1115340
        },
        {
            "id": 1115341
        },
        {
            "id": 1115342
        },
        {
            "id": 1115343
        },
        {
            "id": 1115344
        },
        {
            "id": 1115345
        },
        {
            "id": 1115346
        },
        {
            "id": 1115347
        },
        {
            "id": 1115348
        },
        {
            "id": 1115349
        },
        {
            "id": 1115350
        },
        {
            "id": 1115351
        },
        {
            "id": 1115352
        },
        {
            "id": 1115353
        },
        {
            "id": 1115354
        },
        {
            "id": 1115355
        },
        {
            "id": 1115356
        },
        {
            "id": 1115357
        },
        {
            "id": 1115358
        },
        {
            "id": 1115359
        },
        {
            "id": 1115360
        },
        {
            "id": 1115361
        },
        {
            "id": 1115362
        },
        {
            "id": 1115363
        },
        {
            "id": 1115364
        },
        {
            "id": 1115365
        },
        {
            "id": 1115366
        },
        {
            "id": 1115367
        },
        {
            "id": 1115368
        },
        {
            "id": 1115369
        },
        {
            "id": 1115370
        },
        {
            "id": 1115371
        },
        {
            "id": 1115372
        },
        {
            "id": 1115373
        },
        {
            "id": 1115374
        },
        {
            "id": 1115375
        },
        {
            "id": 1115376
        },
        {
            "id": 1115377
        },
        {
            "id": 1115378
        },
        {
            "id": 1115379
        },
        {
            "id": 1115380
        },
        {
            "id": 1115381
        },
        {
            "id": 1115382
        },
        {
            "id": 1115383
        },
        {
            "id": 1115384
        },
        {
            "id": 1115385
        },
        {
            "id": 1115386
        },
        {
            "id": 1115387
        },
        {
            "id": 1115388
        },
        {
            "id": 1115389
        },
        {
            "id": 1115390
        },
        {
            "id": 1115391
        },
        {
            "id": 1115392
        },
        {
            "id": 1115393
        },
        {
            "id": 1115394
        },
        {
            "id": 1115395
        },
        {
            "id": 1115396
        },
        {
            "id": 1115397
        },
        {
            "id": 1115398
        },
        {
            "id": 1115399
        },
        {
            "id": 1115400
        },
        {
            "id": 1115401
        },
        {
            "id": 1115402
        },
        {
            "id": 1115403
        },
        {
            "id": 1115404
        },
        {
            "id": 1115405
        },
        {
            "id": 1115406
        },
        {
            "id": 1115407
        },
        {
            "id": 1115408
        },
        {
            "id": 1115409
        },
        {
            "id": 1115410
        },
        {
            "id": 1115411
        },
        {
            "id": 1115412
        },
        {
            "id": 1115413
        },
        {
            "id": 1115414
        },
        {
            "id": 1115415
        },
        {
            "id": 1115416
        },
        {
            "id": 1115417
        },
        {
            "id": 1115418
        },
        {
            "id": 1115419
        },
        {
            "id": 1115420
        },
        {
            "id": 1115421
        },
        {
            "id": 1115422
        },
        {
            "id": 1115423
        },
        {
            "id": 1115424
        },
        {
            "id": 1115425
        },
        {
            "id": 1115426
        },
        {
            "id": 1115427
        },
        {
            "id": 1115428
        },
        {
            "id": 1115429
        },
        {
            "id": 1115430
        },
        {
            "id": 1115431
        },
        {
            "id": 1115432
        },
        {
            "id": 1115433
        },
        {
            "id": 1115434
        },
        {
            "id": 1115435
        },
        {
            "id": 1115436
        },
        {
            "id": 1115437
        },
        {
            "id": 1115438
        },
        {
            "id": 1115439
        },
        {
            "id": 1115440
        },
        {
            "id": 1115441
        },
        {
            "id": 1115442
        },
        {
            "id": 1115443
        },
        {
            "id": 1115444
        },
        {
            "id": 1115445
        },
        {
            "id": 1115446
        },
        {
            "id": 1115447
        },
        {
            "id": 1115448
        },
        {
            "id": 1115449
        },
        {
            "id": 1115450
        },
        {
            "id": 1115451
        },
        {
            "id": 1115452
        },
        {
            "id": 1115453
        },
        {
            "id": 1115454
        },
        {
            "id": 1115455
        },
        {
            "id": 1115456
        },
        {
            "id": 1115457
        },
        {
            "id": 1115458
        },
        {
            "id": 1115459
        },
        {
            "id": 1115460
        },
        {
            "id": 1115461
        },
        {
            "id": 1115462
        },
        {
            "id": 1115463
        },
        {
            "id": 1115464
        },
        {
            "id": 1115465
        },
        {
            "id": 1115466
        },
        {
            "id": 1115467
        },
        {
            "id": 1115468
        },
        {
            "id": 1115469
        },
        {
            "id": 1115470
        },
        {
            "id": 1115471
        },
        {
            "id": 1115472
        },
        {
            "id": 1115473
        },
        {
            "id": 1115474
        },
        {
            "id": 1115475
        },
        {
            "id": 1115476
        },
        {
            "id": 1115477
        },
        {
            "id": 1115478
        },
        {
            "id": 1115479
        },
        {
            "id": 1115480
        },
        {
            "id": 1115481
        },
        {
            "id": 1115482
        },
        {
            "id": 1115483
        },
        {
            "id": 1115484
        },
        {
            "id": 1115485
        },
        {
            "id": 1115486
        },
        {
            "id": 1115487
        },
        {
            "id": 1115488
        },
        {
            "id": 1115489
        },
        {
            "id": 1115490
        },
        {
            "id": 1115491
        },
        {
            "id": 1115492
        },
        {
            "id": 1115493
        },
        {
            "id": 1115494
        },
        {
            "id": 1115495
        },
        {
            "id": 1115496
        },
        {
            "id": 1115497
        },
        {
            "id": 1115498
        },
        {
            "id": 1115499
        },
        {
            "id": 1115627
        },
        {
            "id": 1115628
        },
        {
            "id": 1115629
        },
        {
            "id": 1115630
        },
        {
            "id": 1115631
        },
        {
            "id": 1115632
        },
        {
            "id": 1115633
        },
        {
            "id": 1115634
        },
        {
            "id": 1115635
        },
        {
            "id": 1115636
        },
        {
            "id": 1115637
        },
        {
            "id": 1115638
        },
        {
            "id": 1115639
        },
        {
            "id": 1115640
        },
        {
            "id": 1115641
        },
        {
            "id": 1115642
        },
        {
            "id": 1115643
        },
        {
            "id": 1115644
        },
        {
            "id": 1115645
        },
        {
            "id": 1115646
        },
        {
            "id": 1115647
        },
        {
            "id": 1115648
        },
        {
            "id": 1115649
        },
        {
            "id": 1115650
        },
        {
            "id": 1115651
        },
        {
            "id": 1115652
        },
        {
            "id": 1115653
        },
        {
            "id": 1115654
        },
        {
            "id": 1115655
        },
        {
            "id": 1115656
        },
        {
            "id": 1115657
        },
        {
            "id": 1115658
        },
        {
            "id": 1115659
        },
        {
            "id": 1115660
        },
        {
            "id": 1115661
        },
        {
            "id": 1115662
        },
        {
            "id": 1115663
        },
        {
            "id": 1115664
        },
        {
            "id": 1115665
        },
        {
            "id": 1115666
        },
        {
            "id": 1115667
        },
        {
            "id": 1115668
        },
        {
            "id": 1115669
        },
        {
            "id": 1115670
        },
        {
            "id": 1115671
        },
        {
            "id": 1115672
        },
        {
            "id": 1115673
        },
        {
            "id": 1115674
        },
        {
            "id": 1115675
        },
        {
            "id": 1115676
        },
        {
            "id": 1115677
        },
        {
            "id": 1115678
        },
        {
            "id": 1115679
        },
        {
            "id": 1115680
        },
        {
            "id": 1115681
        },
        {
            "id": 1115682
        },
        {
            "id": 1115683
        },
        {
            "id": 1115684
        },
        {
            "id": 1115685
        },
        {
            "id": 1115686
        },
        {
            "id": 1115687
        },
        {
            "id": 1115688
        },
        {
            "id": 1115689
        },
        {
            "id": 1115690
        },
        {
            "id": 1115691
        },
        {
            "id": 1115692
        },
        {
            "id": 1115693
        },
        {
            "id": 1115694
        },
        {
            "id": 1115695
        },
        {
            "id": 1115696
        },
        {
            "id": 1115697
        },
        {
            "id": 1115698
        },
        {
            "id": 1115699
        },
        {
            "id": 1115700
        },
        {
            "id": 1115701
        },
        {
            "id": 1115702
        },
        {
            "id": 1115703
        },
        {
            "id": 1115704
        },
        {
            "id": 1115705
        },
        {
            "id": 1115706
        },
        {
            "id": 1115707
        },
        {
            "id": 1115708
        },
        {
            "id": 1115709
        },
        {
            "id": 1115710
        },
        {
            "id": 1115711
        },
        {
            "id": 1115712
        },
        {
            "id": 1115713
        },
        {
            "id": 1115714
        },
        {
            "id": 1115715
        },
        {
            "id": 1115716
        },
        {
            "id": 1115717
        },
        {
            "id": 1115718
        },
        {
            "id": 1115719
        },
        {
            "id": 1115720
        },
        {
            "id": 1115721
        },
        {
            "id": 1115722
        },
        {
            "id": 1115723
        },
        {
            "id": 1115724
        },
        {
            "id": 1115725
        },
        {
            "id": 1115726
        },
        {
            "id": 1115727
        },
        {
            "id": 1115728
        },
        {
            "id": 1115729
        },
        {
            "id": 1115730
        },
        {
            "id": 1115731
        },
        {
            "id": 1115732
        },
        {
            "id": 1115733
        },
        {
            "id": 1115734
        },
        {
            "id": 1115740
        },
        {
            "id": 1115741
        },
        {
            "id": 1115742
        },
        {
            "id": 1115743
        },
        {
            "id": 1115744
        },
        {
            "id": 1115745
        },
        {
            "id": 1115746
        },
        {
            "id": 1115747
        },
        {
            "id": 1115748
        },
        {
            "id": 1115749
        },
        {
            "id": 1115750
        },
        {
            "id": 1115751
        },
        {
            "id": 1115752
        },
        {
            "id": 1115753
        },
        {
            "id": 1115754
        },
        {
            "id": 1115755
        },
        {
            "id": 1115756
        },
        {
            "id": 1115757
        },
        {
            "id": 1115758
        },
        {
            "id": 1115759
        },
        {
            "id": 1115760
        },
        {
            "id": 1115761
        },
        {
            "id": 1115762
        },
        {
            "id": 1115763
        },
        {
            "id": 1115764
        },
        {
            "id": 1115765
        },
        {
            "id": 1115766
        },
        {
            "id": 1115767
        },
        {
            "id": 1115768
        },
        {
            "id": 1115769
        },
        {
            "id": 1115770
        },
        {
            "id": 1115771
        },
        {
            "id": 1115772
        },
        {
            "id": 1115773
        },
        {
            "id": 1115774
        },
        {
            "id": 1115775
        },
        {
            "id": 1115776
        },
        {
            "id": 1115777
        },
        {
            "id": 1115778
        },
        {
            "id": 1115779
        },
        {
            "id": 1115780
        },
        {
            "id": 1115781
        },
        {
            "id": 1115782
        },
        {
            "id": 1115783
        },
        {
            "id": 1115784
        }
    ]
}