{
    "id": 161346,
    "name": "CVE-2021-27850",
    "cwe": "CWE-502",
    "modified": "2021-06-02T13:15:24",
    "published": "2021-04-15T06:15:14",
    "status": "Analyzed",
    "summary": "A critical unauthenticated remote code execution vulnerability was found all recent versions of Apache Tapestry. The affected versions include 5.4.5, 5.5.0, 5.6.2 and 5.7.0. The vulnerability I have found is a bypass of the fix for CVE-2019-0195. Recap: Before the fix of CVE-2019-0195 it was possible to download arbitrary class files from the classpath by providing a crafted asset file URL. An attacker was able to download the file `AppModule.class` by requesting the URL `http://localhost:8080/assets/something/services/AppModule.class` which contains a HMAC secret key. The fix for that bug was a blacklist filter that checks if the URL ends with `.class`, `.properties` or `.xml`. Bypass: Unfortunately, the blacklist solution can simply be bypassed by appending a `/` at the end of the URL: `http://localhost:8080/assets/something/services/AppModule.class/` The slash is stripped after the blacklist check and the file `AppModule.class` is loaded into the response. This class usually contains the HMAC secret key which is used to sign serialized Java objects. With the knowledge of that key an attacker can sign a Java gadget chain that leads to RCE (e.g. CommonsBeanUtils1 from ysoserial). Solution for this vulnerability: * For Apache Tapestry 5.4.0 to 5.6.1, upgrade to 5.6.2 or later. * For Apache Tapestry 5.7.0, upgrade to 5.7.1 or later.",
    "cvss3": {
        "cvss": 9.8,
        "exploitability_score": 3.9,
        "impact_score": 5.9,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    },
    "cvss2": {
        "exploitability_score": 10.0,
        "impact_score": 10.0,
        "cvss": 10.0,
        "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"
    },
    "cpes": [
        {
            "id": 362396
        },
        {
            "id": 362397
        },
        {
            "id": 362398
        },
        {
            "id": 362399
        },
        {
            "id": 362667
        },
        {
            "id": 606419
        },
        {
            "id": 606420
        },
        {
            "id": 606421
        },
        {
            "id": 635553
        },
        {
            "id": 635554
        },
        {
            "id": 635555
        },
        {
            "id": 635556
        },
        {
            "id": 635557
        },
        {
            "id": 635558
        },
        {
            "id": 635559
        },
        {
            "id": 635560
        },
        {
            "id": 635561
        },
        {
            "id": 635562
        },
        {
            "id": 635563
        },
        {
            "id": 635564
        },
        {
            "id": 635565
        },
        {
            "id": 635566
        },
        {
            "id": 635567
        },
        {
            "id": 635568
        },
        {
            "id": 635569
        },
        {
            "id": 635570
        },
        {
            "id": 635571
        },
        {
            "id": 635572
        },
        {
            "id": 635573
        },
        {
            "id": 635574
        },
        {
            "id": 635575
        },
        {
            "id": 635576
        },
        {
            "id": 635577
        },
        {
            "id": 635578
        },
        {
            "id": 635579
        },
        {
            "id": 635580
        },
        {
            "id": 635581
        },
        {
            "id": 635582
        },
        {
            "id": 635583
        },
        {
            "id": 635584
        },
        {
            "id": 635585
        },
        {
            "id": 635586
        },
        {
            "id": 635587
        },
        {
            "id": 635588
        },
        {
            "id": 635589
        },
        {
            "id": 635590
        },
        {
            "id": 635591
        },
        {
            "id": 635592
        },
        {
            "id": 635593
        },
        {
            "id": 635594
        },
        {
            "id": 635595
        },
        {
            "id": 635596
        },
        {
            "id": 635597
        },
        {
            "id": 635598
        },
        {
            "id": 635599
        },
        {
            "id": 635600
        },
        {
            "id": 635601
        },
        {
            "id": 635602
        },
        {
            "id": 635603
        },
        {
            "id": 635604
        },
        {
            "id": 635605
        },
        {
            "id": 635606
        },
        {
            "id": 635607
        },
        {
            "id": 635608
        },
        {
            "id": 635609
        },
        {
            "id": 635610
        },
        {
            "id": 635611
        },
        {
            "id": 635612
        },
        {
            "id": 635613
        },
        {
            "id": 635614
        },
        {
            "id": 635615
        },
        {
            "id": 635616
        },
        {
            "id": 635617
        },
        {
            "id": 635618
        },
        {
            "id": 635619
        },
        {
            "id": 635620
        },
        {
            "id": 635621
        },
        {
            "id": 635622
        },
        {
            "id": 635623
        },
        {
            "id": 635624
        },
        {
            "id": 635625
        },
        {
            "id": 635626
        },
        {
            "id": 635627
        },
        {
            "id": 635628
        },
        {
            "id": 635629
        },
        {
            "id": 635630
        },
        {
            "id": 635631
        },
        {
            "id": 635632
        },
        {
            "id": 635633
        },
        {
            "id": 698718
        }
    ]
}