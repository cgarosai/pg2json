{
    "id": 186023,
    "name": "CVE-2022-29171",
    "cwe": "CWE-94",
    "modified": "2023-07-21T14:42:41",
    "published": "2022-05-05T22:15:08",
    "status": "Analyzed",
    "summary": "Sourcegraph is a fast and featureful code search and navigation engine. Versions before 3.38.0 are vulnerable to Remote Code Execution in the gitserver service. The Gitolite code host integration with Phabricator allows Sourcegraph site admins to specify a `callsignCommand`, which is used to obtain the Phabricator metadata for a Gitolite repository. An administrator who is able to edit or add a Gitolite code host and has administrative access to Sourcegraph\u2019s bundled Grafana instance can change this command arbitrarily and run it remotely. This grants direct access to the infrastructure underlying the Sourcegraph installation. The attack requires: site-admin privileges on the instance of Sourcegraph, Administrative privileges on the bundled Grafana monitoring instance, Knowledge of the gitserver IP address or DNS name (if running in Kubernetes). This can be found through Grafana. The issue is patched in version 3.38.0. You may disable Gitolite code hosts. We still highly encourage upgrading regardless of workarounds.",
    "cvss3": {
        "cvss": 7.2,
        "exploitability_score": 1.2,
        "impact_score": 5.9,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
    },
    "cvss2": {
        "exploitability_score": 6.8,
        "impact_score": 6.4,
        "cvss": 6.0,
        "vector": "AV:N/AC:M/Au:S/C:P/I:P/A:P"
    },
    "cpes": [
        {
            "id": 534379
        },
        {
            "id": 534380
        },
        {
            "id": 534381
        },
        {
            "id": 534382
        },
        {
            "id": 534383
        },
        {
            "id": 534384
        },
        {
            "id": 534385
        },
        {
            "id": 534386
        },
        {
            "id": 534387
        },
        {
            "id": 534388
        },
        {
            "id": 534389
        },
        {
            "id": 534390
        },
        {
            "id": 534391
        },
        {
            "id": 534392
        },
        {
            "id": 534393
        },
        {
            "id": 534394
        },
        {
            "id": 534395
        },
        {
            "id": 534396
        },
        {
            "id": 534397
        },
        {
            "id": 534398
        },
        {
            "id": 534399
        },
        {
            "id": 534400
        },
        {
            "id": 534401
        },
        {
            "id": 534402
        },
        {
            "id": 534403
        },
        {
            "id": 534404
        },
        {
            "id": 534405
        },
        {
            "id": 534406
        },
        {
            "id": 534407
        },
        {
            "id": 534408
        },
        {
            "id": 534409
        },
        {
            "id": 534410
        },
        {
            "id": 534411
        },
        {
            "id": 534412
        },
        {
            "id": 534413
        },
        {
            "id": 534414
        },
        {
            "id": 534415
        },
        {
            "id": 534416
        },
        {
            "id": 534417
        },
        {
            "id": 534418
        },
        {
            "id": 534419
        },
        {
            "id": 534420
        },
        {
            "id": 534421
        },
        {
            "id": 534422
        },
        {
            "id": 534423
        },
        {
            "id": 534424
        },
        {
            "id": 534425
        },
        {
            "id": 534426
        },
        {
            "id": 534427
        },
        {
            "id": 534428
        },
        {
            "id": 534429
        },
        {
            "id": 534430
        },
        {
            "id": 534431
        },
        {
            "id": 534432
        },
        {
            "id": 534433
        },
        {
            "id": 534434
        },
        {
            "id": 534435
        },
        {
            "id": 534436
        },
        {
            "id": 534437
        },
        {
            "id": 534438
        },
        {
            "id": 534439
        },
        {
            "id": 534440
        },
        {
            "id": 534441
        },
        {
            "id": 534442
        },
        {
            "id": 534443
        },
        {
            "id": 534444
        },
        {
            "id": 534445
        },
        {
            "id": 534446
        },
        {
            "id": 534447
        },
        {
            "id": 534448
        },
        {
            "id": 534449
        },
        {
            "id": 534450
        },
        {
            "id": 534451
        },
        {
            "id": 534452
        },
        {
            "id": 534453
        },
        {
            "id": 534454
        },
        {
            "id": 534455
        },
        {
            "id": 534456
        },
        {
            "id": 534457
        },
        {
            "id": 534458
        },
        {
            "id": 534459
        },
        {
            "id": 534460
        },
        {
            "id": 534461
        },
        {
            "id": 534462
        },
        {
            "id": 534463
        },
        {
            "id": 534464
        },
        {
            "id": 534465
        },
        {
            "id": 534466
        },
        {
            "id": 534467
        },
        {
            "id": 534468
        },
        {
            "id": 534469
        },
        {
            "id": 534470
        },
        {
            "id": 534471
        },
        {
            "id": 534472
        },
        {
            "id": 534473
        },
        {
            "id": 534474
        },
        {
            "id": 534475
        },
        {
            "id": 534476
        },
        {
            "id": 534477
        },
        {
            "id": 534478
        },
        {
            "id": 534479
        },
        {
            "id": 534480
        },
        {
            "id": 534481
        },
        {
            "id": 534482
        },
        {
            "id": 534483
        },
        {
            "id": 534484
        },
        {
            "id": 534485
        },
        {
            "id": 534486
        },
        {
            "id": 534487
        },
        {
            "id": 534488
        },
        {
            "id": 534489
        },
        {
            "id": 534490
        },
        {
            "id": 534491
        },
        {
            "id": 534492
        },
        {
            "id": 534493
        },
        {
            "id": 534494
        },
        {
            "id": 534495
        },
        {
            "id": 534496
        },
        {
            "id": 534497
        },
        {
            "id": 534498
        },
        {
            "id": 534499
        },
        {
            "id": 534500
        },
        {
            "id": 534501
        },
        {
            "id": 534502
        },
        {
            "id": 534503
        },
        {
            "id": 534504
        },
        {
            "id": 534505
        },
        {
            "id": 534506
        },
        {
            "id": 534507
        },
        {
            "id": 534508
        },
        {
            "id": 534509
        },
        {
            "id": 534510
        },
        {
            "id": 534511
        },
        {
            "id": 534512
        },
        {
            "id": 534513
        },
        {
            "id": 534514
        },
        {
            "id": 534515
        },
        {
            "id": 534516
        },
        {
            "id": 534517
        },
        {
            "id": 534518
        },
        {
            "id": 534519
        },
        {
            "id": 534520
        },
        {
            "id": 534521
        },
        {
            "id": 534522
        },
        {
            "id": 534523
        },
        {
            "id": 534524
        },
        {
            "id": 534525
        },
        {
            "id": 534526
        },
        {
            "id": 534527
        },
        {
            "id": 534528
        },
        {
            "id": 534529
        },
        {
            "id": 534530
        },
        {
            "id": 534531
        },
        {
            "id": 534532
        },
        {
            "id": 534533
        },
        {
            "id": 534534
        },
        {
            "id": 534535
        },
        {
            "id": 534536
        },
        {
            "id": 534537
        },
        {
            "id": 534538
        },
        {
            "id": 534539
        },
        {
            "id": 534540
        },
        {
            "id": 534541
        },
        {
            "id": 534542
        },
        {
            "id": 534543
        },
        {
            "id": 534544
        },
        {
            "id": 534545
        },
        {
            "id": 534546
        },
        {
            "id": 534547
        },
        {
            "id": 534548
        },
        {
            "id": 534549
        },
        {
            "id": 534550
        },
        {
            "id": 534551
        },
        {
            "id": 534552
        },
        {
            "id": 534553
        },
        {
            "id": 534554
        },
        {
            "id": 534555
        },
        {
            "id": 534556
        },
        {
            "id": 534557
        },
        {
            "id": 534558
        },
        {
            "id": 534559
        },
        {
            "id": 534560
        },
        {
            "id": 534561
        },
        {
            "id": 534562
        },
        {
            "id": 534563
        },
        {
            "id": 534564
        },
        {
            "id": 534565
        },
        {
            "id": 534566
        },
        {
            "id": 534567
        },
        {
            "id": 534568
        },
        {
            "id": 534569
        },
        {
            "id": 534570
        },
        {
            "id": 534571
        },
        {
            "id": 534572
        },
        {
            "id": 534573
        },
        {
            "id": 534574
        },
        {
            "id": 534575
        },
        {
            "id": 534576
        },
        {
            "id": 534577
        },
        {
            "id": 534578
        },
        {
            "id": 534579
        },
        {
            "id": 534580
        },
        {
            "id": 534581
        },
        {
            "id": 534582
        },
        {
            "id": 534583
        },
        {
            "id": 534584
        },
        {
            "id": 534585
        },
        {
            "id": 534586
        },
        {
            "id": 534587
        },
        {
            "id": 534588
        },
        {
            "id": 534589
        },
        {
            "id": 534590
        },
        {
            "id": 534591
        },
        {
            "id": 534592
        },
        {
            "id": 534593
        },
        {
            "id": 534594
        },
        {
            "id": 534595
        },
        {
            "id": 534596
        },
        {
            "id": 534597
        },
        {
            "id": 534598
        },
        {
            "id": 752202
        },
        {
            "id": 752203
        },
        {
            "id": 776267
        },
        {
            "id": 776268
        },
        {
            "id": 776269
        },
        {
            "id": 776270
        },
        {
            "id": 776271
        },
        {
            "id": 776272
        },
        {
            "id": 776273
        },
        {
            "id": 776274
        },
        {
            "id": 776275
        },
        {
            "id": 776276
        },
        {
            "id": 776277
        },
        {
            "id": 776278
        },
        {
            "id": 776279
        },
        {
            "id": 776280
        },
        {
            "id": 776281
        },
        {
            "id": 776282
        },
        {
            "id": 776283
        },
        {
            "id": 776284
        },
        {
            "id": 776285
        },
        {
            "id": 776286
        },
        {
            "id": 776287
        },
        {
            "id": 776288
        },
        {
            "id": 776289
        },
        {
            "id": 776290
        },
        {
            "id": 776291
        },
        {
            "id": 776292
        },
        {
            "id": 776293
        },
        {
            "id": 776294
        },
        {
            "id": 776295
        },
        {
            "id": 776296
        },
        {
            "id": 776297
        },
        {
            "id": 776298
        },
        {
            "id": 776299
        },
        {
            "id": 776300
        },
        {
            "id": 776301
        },
        {
            "id": 776302
        },
        {
            "id": 776303
        },
        {
            "id": 776304
        },
        {
            "id": 776305
        },
        {
            "id": 776306
        },
        {
            "id": 776307
        },
        {
            "id": 776308
        },
        {
            "id": 776309
        },
        {
            "id": 776310
        },
        {
            "id": 776311
        },
        {
            "id": 776312
        },
        {
            "id": 776313
        },
        {
            "id": 776314
        },
        {
            "id": 776315
        },
        {
            "id": 776316
        },
        {
            "id": 776317
        },
        {
            "id": 776318
        },
        {
            "id": 776319
        },
        {
            "id": 776320
        },
        {
            "id": 776321
        },
        {
            "id": 776322
        },
        {
            "id": 776323
        },
        {
            "id": 776324
        },
        {
            "id": 776325
        },
        {
            "id": 776326
        },
        {
            "id": 776327
        },
        {
            "id": 776328
        },
        {
            "id": 776329
        },
        {
            "id": 776330
        },
        {
            "id": 776331
        },
        {
            "id": 776332
        },
        {
            "id": 776333
        },
        {
            "id": 776334
        },
        {
            "id": 776335
        },
        {
            "id": 776336
        },
        {
            "id": 776337
        },
        {
            "id": 776338
        },
        {
            "id": 776339
        },
        {
            "id": 776340
        },
        {
            "id": 776341
        },
        {
            "id": 776342
        },
        {
            "id": 776343
        },
        {
            "id": 776344
        },
        {
            "id": 776345
        },
        {
            "id": 776346
        },
        {
            "id": 776347
        },
        {
            "id": 776348
        },
        {
            "id": 776349
        },
        {
            "id": 776350
        },
        {
            "id": 776351
        },
        {
            "id": 776352
        },
        {
            "id": 776353
        },
        {
            "id": 776354
        },
        {
            "id": 776355
        },
        {
            "id": 776356
        },
        {
            "id": 776357
        },
        {
            "id": 776358
        },
        {
            "id": 776359
        },
        {
            "id": 776360
        },
        {
            "id": 776361
        },
        {
            "id": 776362
        },
        {
            "id": 776363
        },
        {
            "id": 776364
        },
        {
            "id": 776365
        },
        {
            "id": 776366
        },
        {
            "id": 776367
        },
        {
            "id": 776368
        },
        {
            "id": 776369
        },
        {
            "id": 776370
        },
        {
            "id": 776371
        },
        {
            "id": 776372
        },
        {
            "id": 776373
        },
        {
            "id": 776374
        },
        {
            "id": 776375
        },
        {
            "id": 776376
        },
        {
            "id": 776377
        },
        {
            "id": 776378
        },
        {
            "id": 776379
        },
        {
            "id": 776380
        },
        {
            "id": 776381
        },
        {
            "id": 776382
        },
        {
            "id": 776383
        },
        {
            "id": 776384
        },
        {
            "id": 776385
        },
        {
            "id": 776386
        },
        {
            "id": 776387
        },
        {
            "id": 776388
        },
        {
            "id": 776389
        },
        {
            "id": 776390
        },
        {
            "id": 776391
        },
        {
            "id": 776392
        },
        {
            "id": 776393
        },
        {
            "id": 776394
        },
        {
            "id": 776395
        },
        {
            "id": 776396
        },
        {
            "id": 828011
        },
        {
            "id": 828012
        },
        {
            "id": 828013
        },
        {
            "id": 828014
        },
        {
            "id": 828015
        },
        {
            "id": 828016
        },
        {
            "id": 828017
        },
        {
            "id": 828018
        },
        {
            "id": 828019
        },
        {
            "id": 828020
        },
        {
            "id": 828021
        },
        {
            "id": 828022
        },
        {
            "id": 828023
        },
        {
            "id": 828024
        },
        {
            "id": 828025
        },
        {
            "id": 828026
        },
        {
            "id": 828027
        },
        {
            "id": 828028
        },
        {
            "id": 828029
        },
        {
            "id": 828030
        },
        {
            "id": 844222
        },
        {
            "id": 844223
        },
        {
            "id": 844224
        },
        {
            "id": 844225
        },
        {
            "id": 844226
        },
        {
            "id": 844227
        },
        {
            "id": 844228
        },
        {
            "id": 844229
        },
        {
            "id": 844230
        },
        {
            "id": 844231
        },
        {
            "id": 844232
        },
        {
            "id": 844233
        },
        {
            "id": 844234
        },
        {
            "id": 844235
        },
        {
            "id": 844236
        },
        {
            "id": 844237
        },
        {
            "id": 844238
        },
        {
            "id": 844239
        },
        {
            "id": 855334
        },
        {
            "id": 855335
        }
    ]
}