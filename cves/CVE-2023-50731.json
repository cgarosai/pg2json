{
    "id": 234122,
    "name": "CVE-2023-50731",
    "cwe": "CWE-22",
    "modified": "2024-01-05T11:08:43",
    "published": "2023-12-22T20:15:08",
    "status": "Analyzed",
    "summary": "MindsDB is a SQL Server for artificial intelligence. Prior to version 23.11.4.1, the `put` method in `mindsdb/mindsdb/api/http/namespaces/file.py` does not validate the user-controlled name value, which is used in a temporary file name, which is afterwards opened for writing on lines 122-125, which leads to path injection. Later in the method, the temporary directory is deleted on line 151, but since we can write outside of the directory using the path injection vulnerability, the potentially dangerous file is not deleted. Arbitrary file contents can be written due to `f.write(chunk)` on line 125. Mindsdb does check later on line 149 in the `save_file` method in `file-controller.py` which calls the `_handle_source` method in `file_handler.py` if a file is of one of the types `csv`, `json`, `parquet`, `xls`, or `xlsx`. However, since the check happens after the file has already been written, the files will still exist (and will not be removed due to the path injection described earlier), just the `_handle_source` method will return an error. The same user-controlled source source is used also in another path injection sink on line 138. This leads to another path injection, which allows an attacker to delete any `zip` or `tar.gz` files on the server.",
    "cvss3": {
        "cvss": 9.1,
        "exploitability_score": 3.9,
        "impact_score": 5.2,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H"
    },
    "cvss2": null,
    "cpes": [
        {
            "id": 1054543
        },
        {
            "id": 1054544
        },
        {
            "id": 1054545
        },
        {
            "id": 1054546
        },
        {
            "id": 1054547
        },
        {
            "id": 1054548
        },
        {
            "id": 1054549
        },
        {
            "id": 1054550
        },
        {
            "id": 1054551
        },
        {
            "id": 1054552
        },
        {
            "id": 1054553
        },
        {
            "id": 1054554
        },
        {
            "id": 1054555
        },
        {
            "id": 1054556
        },
        {
            "id": 1054557
        },
        {
            "id": 1054558
        },
        {
            "id": 1054559
        },
        {
            "id": 1054560
        },
        {
            "id": 1054561
        },
        {
            "id": 1054562
        },
        {
            "id": 1054563
        },
        {
            "id": 1054564
        },
        {
            "id": 1054565
        },
        {
            "id": 1054566
        },
        {
            "id": 1054567
        },
        {
            "id": 1054568
        },
        {
            "id": 1054569
        },
        {
            "id": 1054570
        },
        {
            "id": 1054571
        },
        {
            "id": 1054572
        },
        {
            "id": 1054573
        },
        {
            "id": 1054574
        },
        {
            "id": 1054575
        },
        {
            "id": 1054576
        },
        {
            "id": 1054577
        },
        {
            "id": 1054578
        },
        {
            "id": 1054579
        },
        {
            "id": 1054580
        },
        {
            "id": 1054581
        },
        {
            "id": 1054582
        },
        {
            "id": 1054583
        },
        {
            "id": 1054584
        },
        {
            "id": 1054585
        },
        {
            "id": 1054586
        },
        {
            "id": 1054587
        },
        {
            "id": 1054588
        },
        {
            "id": 1054589
        },
        {
            "id": 1054590
        },
        {
            "id": 1054591
        },
        {
            "id": 1054592
        },
        {
            "id": 1054593
        },
        {
            "id": 1054594
        },
        {
            "id": 1054595
        },
        {
            "id": 1054596
        },
        {
            "id": 1054597
        },
        {
            "id": 1054598
        },
        {
            "id": 1054599
        },
        {
            "id": 1054600
        },
        {
            "id": 1054601
        },
        {
            "id": 1054602
        },
        {
            "id": 1054603
        },
        {
            "id": 1054604
        },
        {
            "id": 1054605
        },
        {
            "id": 1054606
        },
        {
            "id": 1054607
        },
        {
            "id": 1054608
        },
        {
            "id": 1054609
        },
        {
            "id": 1054610
        },
        {
            "id": 1054611
        },
        {
            "id": 1054612
        },
        {
            "id": 1054613
        },
        {
            "id": 1054614
        },
        {
            "id": 1054615
        },
        {
            "id": 1054616
        },
        {
            "id": 1054617
        },
        {
            "id": 1054618
        },
        {
            "id": 1054619
        },
        {
            "id": 1054620
        },
        {
            "id": 1054621
        },
        {
            "id": 1054622
        },
        {
            "id": 1054623
        },
        {
            "id": 1054624
        },
        {
            "id": 1054625
        },
        {
            "id": 1054626
        },
        {
            "id": 1054627
        },
        {
            "id": 1054628
        },
        {
            "id": 1054629
        },
        {
            "id": 1054630
        },
        {
            "id": 1054631
        },
        {
            "id": 1054632
        },
        {
            "id": 1054633
        },
        {
            "id": 1054634
        },
        {
            "id": 1054635
        },
        {
            "id": 1054636
        },
        {
            "id": 1054637
        },
        {
            "id": 1054638
        },
        {
            "id": 1054639
        },
        {
            "id": 1054640
        },
        {
            "id": 1054641
        },
        {
            "id": 1054642
        },
        {
            "id": 1054643
        },
        {
            "id": 1054644
        },
        {
            "id": 1054645
        },
        {
            "id": 1054646
        },
        {
            "id": 1054647
        },
        {
            "id": 1054648
        },
        {
            "id": 1054649
        },
        {
            "id": 1054650
        },
        {
            "id": 1054651
        },
        {
            "id": 1054652
        },
        {
            "id": 1054653
        },
        {
            "id": 1054654
        },
        {
            "id": 1054655
        },
        {
            "id": 1054656
        },
        {
            "id": 1054657
        },
        {
            "id": 1054658
        },
        {
            "id": 1054659
        },
        {
            "id": 1054660
        },
        {
            "id": 1054661
        },
        {
            "id": 1054662
        },
        {
            "id": 1054663
        },
        {
            "id": 1054664
        },
        {
            "id": 1054665
        },
        {
            "id": 1054666
        },
        {
            "id": 1054667
        },
        {
            "id": 1054668
        },
        {
            "id": 1054669
        },
        {
            "id": 1054670
        },
        {
            "id": 1054671
        },
        {
            "id": 1054672
        },
        {
            "id": 1054673
        },
        {
            "id": 1054674
        },
        {
            "id": 1054675
        },
        {
            "id": 1054676
        },
        {
            "id": 1054677
        },
        {
            "id": 1054678
        },
        {
            "id": 1054679
        },
        {
            "id": 1054680
        },
        {
            "id": 1054681
        },
        {
            "id": 1054682
        },
        {
            "id": 1054683
        },
        {
            "id": 1054684
        },
        {
            "id": 1054685
        },
        {
            "id": 1054686
        },
        {
            "id": 1054687
        },
        {
            "id": 1054688
        },
        {
            "id": 1054689
        },
        {
            "id": 1054690
        },
        {
            "id": 1054691
        },
        {
            "id": 1054692
        },
        {
            "id": 1054693
        },
        {
            "id": 1054694
        },
        {
            "id": 1054695
        },
        {
            "id": 1054696
        },
        {
            "id": 1054697
        },
        {
            "id": 1054698
        },
        {
            "id": 1054699
        },
        {
            "id": 1054700
        },
        {
            "id": 1054701
        },
        {
            "id": 1054702
        },
        {
            "id": 1054703
        },
        {
            "id": 1054704
        },
        {
            "id": 1054705
        },
        {
            "id": 1054706
        },
        {
            "id": 1054707
        },
        {
            "id": 1054708
        },
        {
            "id": 1054709
        },
        {
            "id": 1054710
        },
        {
            "id": 1054711
        },
        {
            "id": 1054712
        },
        {
            "id": 1054713
        },
        {
            "id": 1054714
        },
        {
            "id": 1054715
        },
        {
            "id": 1054716
        },
        {
            "id": 1054717
        },
        {
            "id": 1054718
        },
        {
            "id": 1054719
        },
        {
            "id": 1054720
        },
        {
            "id": 1054721
        },
        {
            "id": 1054722
        },
        {
            "id": 1138197
        },
        {
            "id": 1138198
        },
        {
            "id": 1138199
        },
        {
            "id": 1138200
        },
        {
            "id": 1138201
        },
        {
            "id": 1138202
        },
        {
            "id": 1138203
        },
        {
            "id": 1138204
        },
        {
            "id": 1138205
        },
        {
            "id": 1138206
        },
        {
            "id": 1138207
        },
        {
            "id": 1138208
        },
        {
            "id": 1138209
        },
        {
            "id": 1138210
        },
        {
            "id": 1138211
        },
        {
            "id": 1138212
        },
        {
            "id": 1138213
        },
        {
            "id": 1138214
        },
        {
            "id": 1138215
        },
        {
            "id": 1138216
        },
        {
            "id": 1138217
        },
        {
            "id": 1138218
        },
        {
            "id": 1138219
        },
        {
            "id": 1138220
        },
        {
            "id": 1138221
        },
        {
            "id": 1220978
        },
        {
            "id": 1220979
        },
        {
            "id": 1220980
        },
        {
            "id": 1220981
        },
        {
            "id": 1220982
        },
        {
            "id": 1220983
        },
        {
            "id": 1220984
        },
        {
            "id": 1220985
        },
        {
            "id": 1220986
        },
        {
            "id": 1220987
        },
        {
            "id": 1220988
        },
        {
            "id": 1220989
        },
        {
            "id": 1220990
        }
    ]
}