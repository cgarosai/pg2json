{
    "id": 239643,
    "name": "CVE-2021-46951",
    "cwe": "CWE-191",
    "modified": "2024-04-10T18:15:55",
    "published": "2024-02-27T18:04:06",
    "status": "Analyzed",
    "summary": "In the Linux kernel, the following vulnerability has been resolved:\n\ntpm: efi: Use local variable for calculating final log size\n\nWhen tpm_read_log_efi is called multiple times, which happens when\none loads and unloads a TPM2 driver multiple times, then the global\nvariable efi_tpm_final_log_size will at some point become a negative\nnumber due to the subtraction of final_events_preboot_size occurring\neach time. Use a local variable to avoid this integer underflow.\n\nThe following issue is now resolved:\n\nMar  8 15:35:12 hibinst kernel: Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 0.0.0 02/06/2015\nMar  8 15:35:12 hibinst kernel: Workqueue: tpm-vtpm vtpm_proxy_work [tpm_vtpm_proxy]\nMar  8 15:35:12 hibinst kernel: RIP: 0010:__memcpy+0x12/0x20\nMar  8 15:35:12 hibinst kernel: Code: 00 b8 01 00 00 00 85 d2 74 0a c7 05 44 7b ef 00 0f 00 00 00 c3 cc cc cc 66 66 90 66 90 48 89 f8 48 89 d1 48 c1 e9 03 83 e2 07 <f3> 48 a5 89 d1 f3 a4 c3 66 0f 1f 44 00 00 48 89 f8 48 89 d1 f3 a4\nMar  8 15:35:12 hibinst kernel: RSP: 0018:ffff9ac4c0fcfde0 EFLAGS: 00010206\nMar  8 15:35:12 hibinst kernel: RAX: ffff88f878cefed5 RBX: ffff88f878ce9000 RCX: 1ffffffffffffe0f\nMar  8 15:35:12 hibinst kernel: RDX: 0000000000000003 RSI: ffff9ac4c003bff9 RDI: ffff88f878cf0e4d\nMar  8 15:35:12 hibinst kernel: RBP: ffff9ac4c003b000 R08: 0000000000001000 R09: 000000007e9d6073\nMar  8 15:35:12 hibinst kernel: R10: ffff9ac4c003b000 R11: ffff88f879ad3500 R12: 0000000000000ed5\nMar  8 15:35:12 hibinst kernel: R13: ffff88f878ce9760 R14: 0000000000000002 R15: ffff88f77de7f018\nMar  8 15:35:12 hibinst kernel: FS:  0000000000000000(0000) GS:ffff88f87bd00000(0000) knlGS:0000000000000000\nMar  8 15:35:12 hibinst kernel: CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nMar  8 15:35:12 hibinst kernel: CR2: ffff9ac4c003c000 CR3: 00000001785a6004 CR4: 0000000000060ee0\nMar  8 15:35:12 hibinst kernel: Call Trace:\nMar  8 15:35:12 hibinst kernel: tpm_read_log_efi+0x152/0x1a7\nMar  8 15:35:12 hibinst kernel: tpm_bios_log_setup+0xc8/0x1c0\nMar  8 15:35:12 hibinst kernel: tpm_chip_register+0x8f/0x260\nMar  8 15:35:12 hibinst kernel: vtpm_proxy_work+0x16/0x60 [tpm_vtpm_proxy]\nMar  8 15:35:12 hibinst kernel: process_one_work+0x1b4/0x370\nMar  8 15:35:12 hibinst kernel: worker_thread+0x53/0x3e0\nMar  8 15:35:12 hibinst kernel: ? process_one_work+0x370/0x370",
    "cvss3": {
        "cvss": 5.5,
        "exploitability_score": 1.8,
        "impact_score": 3.6,
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
    },
    "cvss2": null,
    "cpes": [
        {
            "id": 391395
        },
        {
            "id": 412985
        },
        {
            "id": 412986
        },
        {
            "id": 412987
        },
        {
            "id": 412988
        },
        {
            "id": 412989
        },
        {
            "id": 421252
        },
        {
            "id": 423738
        },
        {
            "id": 432050
        },
        {
            "id": 432051
        },
        {
            "id": 445635
        },
        {
            "id": 453533
        },
        {
            "id": 453950
        },
        {
            "id": 461180
        },
        {
            "id": 465689
        },
        {
            "id": 468276
        },
        {
            "id": 483224
        },
        {
            "id": 483621
        },
        {
            "id": 483622
        },
        {
            "id": 483623
        },
        {
            "id": 483624
        },
        {
            "id": 483625
        },
        {
            "id": 483626
        },
        {
            "id": 483627
        },
        {
            "id": 483628
        },
        {
            "id": 483629
        },
        {
            "id": 483630
        },
        {
            "id": 483631
        },
        {
            "id": 483632
        },
        {
            "id": 483633
        },
        {
            "id": 483634
        },
        {
            "id": 505953
        },
        {
            "id": 505954
        },
        {
            "id": 505955
        },
        {
            "id": 505956
        },
        {
            "id": 505957
        },
        {
            "id": 512081
        },
        {
            "id": 512384
        },
        {
            "id": 512385
        },
        {
            "id": 520171
        },
        {
            "id": 520172
        },
        {
            "id": 520173
        },
        {
            "id": 520174
        },
        {
            "id": 520175
        },
        {
            "id": 520176
        },
        {
            "id": 520177
        },
        {
            "id": 520178
        },
        {
            "id": 520179
        },
        {
            "id": 520180
        },
        {
            "id": 520181
        },
        {
            "id": 522757
        },
        {
            "id": 524568
        },
        {
            "id": 527261
        },
        {
            "id": 534299
        },
        {
            "id": 541116
        },
        {
            "id": 545816
        },
        {
            "id": 545823
        },
        {
            "id": 548384
        },
        {
            "id": 549281
        },
        {
            "id": 549282
        },
        {
            "id": 560333
        },
        {
            "id": 568881
        },
        {
            "id": 568882
        },
        {
            "id": 568883
        },
        {
            "id": 578926
        },
        {
            "id": 588470
        },
        {
            "id": 589141
        },
        {
            "id": 590391
        },
        {
            "id": 590562
        },
        {
            "id": 591060
        },
        {
            "id": 591235
        },
        {
            "id": 591236
        },
        {
            "id": 591237
        },
        {
            "id": 591238
        },
        {
            "id": 591239
        },
        {
            "id": 591241
        },
        {
            "id": 591243
        },
        {
            "id": 591244
        },
        {
            "id": 591245
        },
        {
            "id": 591246
        },
        {
            "id": 591247
        },
        {
            "id": 597953
        },
        {
            "id": 597954
        },
        {
            "id": 597955
        },
        {
            "id": 597956
        },
        {
            "id": 597957
        },
        {
            "id": 597958
        },
        {
            "id": 597959
        },
        {
            "id": 597960
        },
        {
            "id": 597961
        },
        {
            "id": 597962
        },
        {
            "id": 597963
        },
        {
            "id": 597964
        },
        {
            "id": 597965
        },
        {
            "id": 597966
        },
        {
            "id": 597967
        },
        {
            "id": 599612
        },
        {
            "id": 599874
        },
        {
            "id": 599875
        },
        {
            "id": 600274
        },
        {
            "id": 604561
        },
        {
            "id": 604562
        },
        {
            "id": 604563
        },
        {
            "id": 604564
        },
        {
            "id": 604565
        },
        {
            "id": 604566
        },
        {
            "id": 606415
        },
        {
            "id": 614510
        },
        {
            "id": 614582
        },
        {
            "id": 614583
        },
        {
            "id": 614584
        },
        {
            "id": 614585
        },
        {
            "id": 614586
        },
        {
            "id": 614587
        },
        {
            "id": 614750
        },
        {
            "id": 615514
        },
        {
            "id": 616063
        },
        {
            "id": 618218
        },
        {
            "id": 620076
        },
        {
            "id": 620077
        },
        {
            "id": 628944
        },
        {
            "id": 628945
        },
        {
            "id": 629670
        },
        {
            "id": 629702
        },
        {
            "id": 635282
        },
        {
            "id": 636053
        },
        {
            "id": 637145
        },
        {
            "id": 637146
        },
        {
            "id": 637147
        },
        {
            "id": 637148
        },
        {
            "id": 637149
        },
        {
            "id": 637150
        },
        {
            "id": 638132
        },
        {
            "id": 640797
        },
        {
            "id": 641971
        },
        {
            "id": 641972
        },
        {
            "id": 641973
        },
        {
            "id": 641974
        },
        {
            "id": 641975
        },
        {
            "id": 641976
        },
        {
            "id": 641977
        },
        {
            "id": 641978
        },
        {
            "id": 641979
        },
        {
            "id": 646212
        },
        {
            "id": 646213
        },
        {
            "id": 646214
        },
        {
            "id": 647069
        },
        {
            "id": 649189
        },
        {
            "id": 649190
        },
        {
            "id": 649191
        },
        {
            "id": 652291
        },
        {
            "id": 652292
        },
        {
            "id": 652293
        },
        {
            "id": 652294
        },
        {
            "id": 655463
        },
        {
            "id": 655464
        },
        {
            "id": 655465
        },
        {
            "id": 656345
        },
        {
            "id": 658021
        },
        {
            "id": 663024
        },
        {
            "id": 663025
        },
        {
            "id": 663026
        },
        {
            "id": 671543
        },
        {
            "id": 671544
        },
        {
            "id": 672941
        },
        {
            "id": 672942
        },
        {
            "id": 672943
        },
        {
            "id": 672944
        },
        {
            "id": 672945
        },
        {
            "id": 672946
        },
        {
            "id": 672947
        },
        {
            "id": 672948
        },
        {
            "id": 672949
        },
        {
            "id": 672950
        },
        {
            "id": 672951
        },
        {
            "id": 672952
        },
        {
            "id": 672953
        },
        {
            "id": 672954
        },
        {
            "id": 672955
        },
        {
            "id": 672956
        },
        {
            "id": 672957
        },
        {
            "id": 672958
        },
        {
            "id": 672959
        },
        {
            "id": 672960
        },
        {
            "id": 672961
        },
        {
            "id": 672962
        },
        {
            "id": 672963
        },
        {
            "id": 672964
        },
        {
            "id": 672965
        },
        {
            "id": 672966
        },
        {
            "id": 672967
        },
        {
            "id": 672968
        },
        {
            "id": 672969
        },
        {
            "id": 672970
        },
        {
            "id": 672971
        },
        {
            "id": 672972
        },
        {
            "id": 677335
        },
        {
            "id": 677336
        },
        {
            "id": 677337
        },
        {
            "id": 684027
        },
        {
            "id": 687818
        },
        {
            "id": 687819
        },
        {
            "id": 687820
        },
        {
            "id": 690122
        },
        {
            "id": 690123
        },
        {
            "id": 690124
        },
        {
            "id": 690125
        },
        {
            "id": 707092
        },
        {
            "id": 708473
        },
        {
            "id": 708474
        },
        {
            "id": 708475
        },
        {
            "id": 708530
        },
        {
            "id": 709496
        },
        {
            "id": 711248
        },
        {
            "id": 711249
        },
        {
            "id": 711250
        },
        {
            "id": 717230
        },
        {
            "id": 717300
        },
        {
            "id": 717301
        },
        {
            "id": 718165
        },
        {
            "id": 718511
        },
        {
            "id": 718512
        },
        {
            "id": 718513
        },
        {
            "id": 718514
        },
        {
            "id": 718515
        },
        {
            "id": 718516
        },
        {
            "id": 718517
        },
        {
            "id": 718956
        },
        {
            "id": 726452
        },
        {
            "id": 726453
        },
        {
            "id": 726454
        },
        {
            "id": 726455
        },
        {
            "id": 726456
        },
        {
            "id": 726457
        },
        {
            "id": 726458
        },
        {
            "id": 726459
        },
        {
            "id": 726460
        },
        {
            "id": 726461
        },
        {
            "id": 726462
        },
        {
            "id": 726463
        },
        {
            "id": 726464
        },
        {
            "id": 726465
        },
        {
            "id": 726466
        },
        {
            "id": 726467
        },
        {
            "id": 760679
        },
        {
            "id": 862142
        },
        {
            "id": 862143
        },
        {
            "id": 862144
        },
        {
            "id": 862145
        },
        {
            "id": 862146
        },
        {
            "id": 862147
        },
        {
            "id": 862148
        },
        {
            "id": 862149
        },
        {
            "id": 862150
        },
        {
            "id": 862151
        },
        {
            "id": 862152
        },
        {
            "id": 862153
        },
        {
            "id": 890568
        },
        {
            "id": 890569
        },
        {
            "id": 890570
        },
        {
            "id": 890571
        },
        {
            "id": 890572
        },
        {
            "id": 890573
        },
        {
            "id": 890574
        },
        {
            "id": 890575
        },
        {
            "id": 890576
        },
        {
            "id": 890577
        },
        {
            "id": 890578
        },
        {
            "id": 890579
        },
        {
            "id": 890580
        },
        {
            "id": 890581
        },
        {
            "id": 890582
        },
        {
            "id": 890583
        },
        {
            "id": 890584
        },
        {
            "id": 890585
        },
        {
            "id": 890586
        },
        {
            "id": 890587
        },
        {
            "id": 890588
        },
        {
            "id": 890589
        },
        {
            "id": 890590
        },
        {
            "id": 890591
        },
        {
            "id": 951779
        },
        {
            "id": 951780
        },
        {
            "id": 951781
        },
        {
            "id": 951782
        },
        {
            "id": 951783
        },
        {
            "id": 951784
        },
        {
            "id": 951785
        },
        {
            "id": 951786
        },
        {
            "id": 951787
        },
        {
            "id": 951788
        },
        {
            "id": 951789
        },
        {
            "id": 951790
        },
        {
            "id": 951791
        },
        {
            "id": 951792
        },
        {
            "id": 951793
        },
        {
            "id": 951794
        },
        {
            "id": 951795
        },
        {
            "id": 951897
        },
        {
            "id": 951898
        },
        {
            "id": 951899
        },
        {
            "id": 951900
        },
        {
            "id": 951901
        },
        {
            "id": 951902
        },
        {
            "id": 951903
        },
        {
            "id": 951904
        },
        {
            "id": 951905
        },
        {
            "id": 951906
        },
        {
            "id": 951907
        },
        {
            "id": 951908
        },
        {
            "id": 951909
        },
        {
            "id": 951910
        },
        {
            "id": 951911
        },
        {
            "id": 951912
        },
        {
            "id": 951913
        },
        {
            "id": 951914
        },
        {
            "id": 951915
        },
        {
            "id": 951916
        },
        {
            "id": 951917
        },
        {
            "id": 951918
        },
        {
            "id": 951919
        },
        {
            "id": 951920
        },
        {
            "id": 951921
        },
        {
            "id": 951922
        },
        {
            "id": 951923
        },
        {
            "id": 951924
        },
        {
            "id": 951925
        },
        {
            "id": 951926
        },
        {
            "id": 951927
        },
        {
            "id": 1018126
        },
        {
            "id": 1066689
        },
        {
            "id": 1066690
        },
        {
            "id": 1066691
        },
        {
            "id": 1066692
        },
        {
            "id": 1066693
        },
        {
            "id": 1096945
        },
        {
            "id": 1096972
        },
        {
            "id": 1097651
        },
        {
            "id": 1097652
        },
        {
            "id": 1097653
        },
        {
            "id": 1097654
        },
        {
            "id": 1097655
        },
        {
            "id": 1097656
        },
        {
            "id": 1097657
        },
        {
            "id": 1097658
        },
        {
            "id": 1267330
        }
    ]
}