{
    "id": 177956,
    "name": "CVE-2022-21682",
    "cwe": "CWE-22",
    "modified": "2023-12-23T09:15:09",
    "published": "2022-01-13T20:15:08",
    "status": "Modified",
    "summary": "Flatpak is a Linux application sandboxing and distribution framework. A path traversal vulnerability affects versions of Flatpak prior to 1.12.3 and 1.10.6. flatpak-builder applies `finish-args` last in the build. At this point the build directory will have the full access that is specified in the manifest, so running `flatpak build` against it will gain those permissions. Normally this will not be done, so this is not problem. However, if `--mirror-screenshots-url` is specified, then flatpak-builder will launch `flatpak build --nofilesystem=host appstream-utils mirror-screenshots` after finalization, which can lead to issues even with the `--nofilesystem=host` protection. In normal use, the only issue is that these empty directories can be created wherever the user has write permissions. However, a malicious application could replace the `appstream-util` binary and potentially do something more hostile. This has been resolved in Flatpak 1.12.3 and 1.10.6 by changing the behaviour of `--nofilesystem=home` and `--nofilesystem=host`.",
    "cvss3": {
        "cvss": 6.5,
        "exploitability_score": 2.8,
        "impact_score": 3.6,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
    },
    "cvss2": {
        "exploitability_score": 8.0,
        "impact_score": 2.9,
        "cvss": 4.0,
        "vector": "AV:N/AC:L/Au:S/C:N/I:P/A:N"
    },
    "cpes": [
        {
            "id": 124875
        },
        {
            "id": 210563
        },
        {
            "id": 210564
        },
        {
            "id": 210565
        },
        {
            "id": 210566
        },
        {
            "id": 210567
        },
        {
            "id": 210568
        },
        {
            "id": 210569
        },
        {
            "id": 210570
        },
        {
            "id": 210571
        },
        {
            "id": 210572
        },
        {
            "id": 210573
        },
        {
            "id": 210574
        },
        {
            "id": 210575
        },
        {
            "id": 210576
        },
        {
            "id": 210577
        },
        {
            "id": 210578
        },
        {
            "id": 210579
        },
        {
            "id": 210580
        },
        {
            "id": 210581
        },
        {
            "id": 210582
        },
        {
            "id": 210583
        },
        {
            "id": 210584
        },
        {
            "id": 210585
        },
        {
            "id": 210586
        },
        {
            "id": 210587
        },
        {
            "id": 210588
        },
        {
            "id": 210589
        },
        {
            "id": 210590
        },
        {
            "id": 210591
        },
        {
            "id": 210592
        },
        {
            "id": 210593
        },
        {
            "id": 210594
        },
        {
            "id": 210595
        },
        {
            "id": 210596
        },
        {
            "id": 210597
        },
        {
            "id": 210598
        },
        {
            "id": 210599
        },
        {
            "id": 210600
        },
        {
            "id": 210601
        },
        {
            "id": 210602
        },
        {
            "id": 210603
        },
        {
            "id": 210604
        },
        {
            "id": 210605
        },
        {
            "id": 210606
        },
        {
            "id": 210607
        },
        {
            "id": 210608
        },
        {
            "id": 210609
        },
        {
            "id": 210610
        },
        {
            "id": 210611
        },
        {
            "id": 210612
        },
        {
            "id": 210613
        },
        {
            "id": 210614
        },
        {
            "id": 210615
        },
        {
            "id": 210616
        },
        {
            "id": 210617
        },
        {
            "id": 210618
        },
        {
            "id": 210619
        },
        {
            "id": 210620
        },
        {
            "id": 210621
        },
        {
            "id": 210622
        },
        {
            "id": 210623
        },
        {
            "id": 210624
        },
        {
            "id": 210625
        },
        {
            "id": 210626
        },
        {
            "id": 210627
        },
        {
            "id": 210628
        },
        {
            "id": 210629
        },
        {
            "id": 210630
        },
        {
            "id": 210631
        },
        {
            "id": 210632
        },
        {
            "id": 210633
        },
        {
            "id": 210634
        },
        {
            "id": 210635
        },
        {
            "id": 210636
        },
        {
            "id": 210637
        },
        {
            "id": 210638
        },
        {
            "id": 210639
        },
        {
            "id": 210640
        },
        {
            "id": 210641
        },
        {
            "id": 210642
        },
        {
            "id": 210643
        },
        {
            "id": 210644
        },
        {
            "id": 210645
        },
        {
            "id": 210646
        },
        {
            "id": 210647
        },
        {
            "id": 210648
        },
        {
            "id": 210649
        },
        {
            "id": 210650
        },
        {
            "id": 210651
        },
        {
            "id": 210652
        },
        {
            "id": 210653
        },
        {
            "id": 210654
        },
        {
            "id": 210655
        },
        {
            "id": 210656
        },
        {
            "id": 210657
        },
        {
            "id": 210658
        },
        {
            "id": 210659
        },
        {
            "id": 210660
        },
        {
            "id": 210661
        },
        {
            "id": 210662
        },
        {
            "id": 210663
        },
        {
            "id": 210664
        },
        {
            "id": 210665
        },
        {
            "id": 210666
        },
        {
            "id": 210667
        },
        {
            "id": 212665
        },
        {
            "id": 212666
        },
        {
            "id": 212667
        },
        {
            "id": 212668
        },
        {
            "id": 267823
        },
        {
            "id": 540323
        },
        {
            "id": 556736
        },
        {
            "id": 587080
        },
        {
            "id": 641146
        },
        {
            "id": 641147
        },
        {
            "id": 641148
        },
        {
            "id": 641149
        },
        {
            "id": 641150
        },
        {
            "id": 641151
        },
        {
            "id": 641152
        },
        {
            "id": 641153
        },
        {
            "id": 641154
        },
        {
            "id": 641155
        },
        {
            "id": 641156
        },
        {
            "id": 641157
        },
        {
            "id": 641158
        },
        {
            "id": 641159
        },
        {
            "id": 641160
        },
        {
            "id": 641161
        },
        {
            "id": 641162
        },
        {
            "id": 641163
        },
        {
            "id": 641164
        },
        {
            "id": 641165
        },
        {
            "id": 641166
        },
        {
            "id": 641167
        },
        {
            "id": 641168
        },
        {
            "id": 641169
        },
        {
            "id": 641170
        },
        {
            "id": 641171
        },
        {
            "id": 641172
        },
        {
            "id": 641173
        },
        {
            "id": 641174
        },
        {
            "id": 641175
        },
        {
            "id": 676754
        },
        {
            "id": 676755
        },
        {
            "id": 707473
        },
        {
            "id": 709505
        },
        {
            "id": 713897
        },
        {
            "id": 774641
        },
        {
            "id": 782767
        },
        {
            "id": 782768
        },
        {
            "id": 782769
        },
        {
            "id": 782770
        },
        {
            "id": 782771
        },
        {
            "id": 782772
        },
        {
            "id": 838718
        },
        {
            "id": 838719
        },
        {
            "id": 838721
        },
        {
            "id": 838722
        },
        {
            "id": 838724
        },
        {
            "id": 838725
        },
        {
            "id": 838726
        },
        {
            "id": 838727
        },
        {
            "id": 838728
        },
        {
            "id": 838729
        },
        {
            "id": 838730
        },
        {
            "id": 838731
        },
        {
            "id": 838732
        },
        {
            "id": 838733
        },
        {
            "id": 838734
        },
        {
            "id": 838735
        },
        {
            "id": 838736
        },
        {
            "id": 838737
        },
        {
            "id": 838738
        },
        {
            "id": 838739
        },
        {
            "id": 838740
        },
        {
            "id": 838741
        },
        {
            "id": 838742
        },
        {
            "id": 838743
        },
        {
            "id": 838744
        },
        {
            "id": 838745
        },
        {
            "id": 838746
        },
        {
            "id": 838747
        },
        {
            "id": 838748
        },
        {
            "id": 838749
        },
        {
            "id": 838750
        },
        {
            "id": 838751
        },
        {
            "id": 838752
        },
        {
            "id": 838753
        },
        {
            "id": 838754
        },
        {
            "id": 838755
        },
        {
            "id": 838756
        },
        {
            "id": 838757
        },
        {
            "id": 838758
        },
        {
            "id": 838759
        },
        {
            "id": 838760
        },
        {
            "id": 1041279
        }
    ]
}