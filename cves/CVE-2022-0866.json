{
    "id": 186238,
    "name": "CVE-2022-0866",
    "cwe": "CWE-863",
    "modified": "2022-05-18T14:13:09",
    "published": "2022-05-10T19:15:08",
    "status": "Analyzed",
    "summary": "This is a concurrency issue that can result in the wrong caller principal being returned from the session context of an EJB that is configured with a RunAs principal. In particular, the org.jboss.as.ejb3.component.EJBComponent class has an incomingRunAsIdentity field. This field is used by the org.jboss.as.ejb3.security.RunAsPrincipalInterceptor to keep track of the current identity prior to switching to a new identity created using the RunAs principal. The exploit consist that the EJBComponent#incomingRunAsIdentity field is currently just a SecurityIdentity. This means in a concurrent environment, where multiple users are repeatedly invoking an EJB that is configured with a RunAs principal, it's possible for the wrong the caller principal to be returned from EJBComponent#getCallerPrincipal. Similarly, it's also possible for EJBComponent#isCallerInRole to return the wrong value. Both of these methods rely on incomingRunAsIdentity. Affects all versions of JBoss EAP from 7.1.0 and all versions of WildFly 11+ when Elytron is enabled.",
    "cvss3": {
        "cvss": 5.3,
        "exploitability_score": 3.9,
        "impact_score": 1.4,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
    },
    "cvss2": {
        "exploitability_score": 8.6,
        "impact_score": 2.9,
        "cvss": 4.3,
        "vector": "AV:N/AC:M/Au:N/C:P/I:N/A:N"
    },
    "cpes": [
        {
            "id": 133794
        },
        {
            "id": 237819
        },
        {
            "id": 238516
        },
        {
            "id": 238517
        },
        {
            "id": 238518
        },
        {
            "id": 238519
        },
        {
            "id": 238520
        },
        {
            "id": 238521
        },
        {
            "id": 309598
        },
        {
            "id": 309599
        },
        {
            "id": 309600
        },
        {
            "id": 309601
        },
        {
            "id": 309602
        },
        {
            "id": 309603
        },
        {
            "id": 309604
        },
        {
            "id": 309605
        },
        {
            "id": 309606
        },
        {
            "id": 334166
        },
        {
            "id": 334167
        },
        {
            "id": 334168
        },
        {
            "id": 334169
        },
        {
            "id": 334170
        },
        {
            "id": 334171
        },
        {
            "id": 334172
        },
        {
            "id": 334173
        },
        {
            "id": 334174
        },
        {
            "id": 334175
        },
        {
            "id": 334176
        },
        {
            "id": 449030
        },
        {
            "id": 487934
        },
        {
            "id": 566856
        },
        {
            "id": 566857
        },
        {
            "id": 566858
        },
        {
            "id": 566859
        },
        {
            "id": 566860
        },
        {
            "id": 570821
        },
        {
            "id": 591125
        },
        {
            "id": 616181
        },
        {
            "id": 616182
        },
        {
            "id": 619735
        },
        {
            "id": 622739
        },
        {
            "id": 623429
        },
        {
            "id": 623430
        },
        {
            "id": 704139
        },
        {
            "id": 704392
        },
        {
            "id": 704393
        },
        {
            "id": 704394
        },
        {
            "id": 704397
        },
        {
            "id": 704398
        },
        {
            "id": 704399
        },
        {
            "id": 704400
        },
        {
            "id": 704986
        },
        {
            "id": 758593
        },
        {
            "id": 758594
        },
        {
            "id": 758595
        },
        {
            "id": 758596
        },
        {
            "id": 758597
        },
        {
            "id": 758598
        },
        {
            "id": 758599
        },
        {
            "id": 758600
        },
        {
            "id": 824599
        },
        {
            "id": 824600
        },
        {
            "id": 922321
        },
        {
            "id": 1037370
        },
        {
            "id": 1037371
        },
        {
            "id": 1037372
        },
        {
            "id": 1037373
        },
        {
            "id": 1037374
        },
        {
            "id": 1037375
        },
        {
            "id": 1037376
        },
        {
            "id": 1037377
        },
        {
            "id": 1037378
        },
        {
            "id": 1037379
        },
        {
            "id": 1186083
        }
    ]
}