{
    "id": 164090,
    "name": "CVE-2021-29504",
    "cwe": "CWE-295",
    "modified": "2021-06-17T13:33:50",
    "published": "2021-06-07T19:15:08",
    "status": "Analyzed",
    "summary": "WP-CLI is the command-line interface for WordPress. An improper error handling in HTTPS requests management in WP-CLI version 0.12.0 and later allows remote attackers able to intercept the communication to remotely disable the certificate verification on WP-CLI side, gaining full control over the communication content, including the ability to impersonate update servers and push malicious updates towards WordPress instances controlled by the vulnerable WP-CLI agent, or push malicious updates toward WP-CLI itself. The vulnerability stems from the fact that the default behavior of `WP_CLI\\Utils\\http_request()` when encountering a TLS handshake error is to disable certificate validation and retry the same request. The default behavior has been changed with version 2.5.0 of WP-CLI and the `wp-cli/wp-cli` framework (via https://github.com/wp-cli/wp-cli/pull/5523) so that the `WP_CLI\\Utils\\http_request()` method accepts an `$insecure` option that is `false` by default and consequently that a TLS handshake failure is a hard error by default. This new default is a breaking change and ripples through to all consumers of `WP_CLI\\Utils\\http_request()`, including those in separate WP-CLI bundled or third-party packages. https://github.com/wp-cli/wp-cli/pull/5523 has also added an `--insecure` flag to the `cli update` command to counter this breaking change. There is no direct workaround for the default insecure behavior of `wp-cli/wp-cli` versions before 2.5.0. The workaround for dealing with the breaking change in the commands directly affected by the new secure default behavior is to add the `--insecure` flag to manually opt-in to the previous insecure behavior.",
    "cvss3": {
        "cvss": 7.4,
        "exploitability_score": 2.2,
        "impact_score": 5.2,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N"
    },
    "cvss2": {
        "exploitability_score": 10.0,
        "impact_score": 6.4,
        "cvss": 7.5,
        "vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P"
    },
    "cpes": [
        {
            "id": 727463
        },
        {
            "id": 727464
        },
        {
            "id": 727465
        },
        {
            "id": 727466
        },
        {
            "id": 727467
        },
        {
            "id": 727468
        },
        {
            "id": 727469
        },
        {
            "id": 727470
        },
        {
            "id": 727471
        },
        {
            "id": 727472
        },
        {
            "id": 727473
        },
        {
            "id": 727474
        },
        {
            "id": 727475
        },
        {
            "id": 727476
        },
        {
            "id": 727477
        },
        {
            "id": 727478
        },
        {
            "id": 727479
        },
        {
            "id": 727480
        },
        {
            "id": 727481
        },
        {
            "id": 727482
        },
        {
            "id": 727483
        },
        {
            "id": 727484
        },
        {
            "id": 727485
        },
        {
            "id": 727486
        },
        {
            "id": 727487
        },
        {
            "id": 727488
        },
        {
            "id": 727489
        },
        {
            "id": 727490
        },
        {
            "id": 727491
        },
        {
            "id": 727492
        },
        {
            "id": 727493
        },
        {
            "id": 727494
        },
        {
            "id": 727495
        },
        {
            "id": 727496
        },
        {
            "id": 727497
        },
        {
            "id": 727498
        },
        {
            "id": 727499
        },
        {
            "id": 727500
        },
        {
            "id": 727501
        },
        {
            "id": 727502
        },
        {
            "id": 727503
        },
        {
            "id": 727504
        },
        {
            "id": 727505
        },
        {
            "id": 727506
        },
        {
            "id": 727507
        },
        {
            "id": 727508
        }
    ]
}