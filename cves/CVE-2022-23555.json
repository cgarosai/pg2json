{
    "id": 203251,
    "name": "CVE-2022-23555",
    "cwe": "CWE-287",
    "modified": "2023-11-07T02:44:13",
    "published": "2022-12-28T00:15:10",
    "status": "Modified",
    "summary": "authentik is an open-source Identity Provider focused on flexibility and versatility. Versions prior to 2022.11.4 and 2022.10.4 are vulnerable to Improper Authentication. Token reuse in invitation URLs leads to access control bypass via the use of a different enrollment flow than in the one provided. The vulnerability allows an attacker that knows different invitation flows names (e.g. `enrollment-invitation-test` and `enrollment-invitation-admin`) via either different invite links or via brute forcing to signup via a single invitation url for any valid invite link received (it can even be a url for a third flow as long as it's a valid invite) as the token used in the `Invitations` section of the Admin interface does NOT change when a different `enrollment flow` is selected via the interface and it is NOT bound to the selected flow, so it will be valid for any flow when used. This issue is patched in authentik 2022.11.4,2022.10.4 and 2022.12.0. Only configurations that use invitations and have multiple enrollment flows with invitation stages that grant different permissions are affected. The default configuration is not vulnerable, and neither are configurations with a single enrollment flow.  As a workaround, fixed data can be added to invitations which can be checked in the flow to deny requests. Alternatively, an identifier with high entropy (like a UUID) can be used as flow slug, mitigating the attack vector by exponentially decreasing the possibility of discovering other flows.",
    "cvss3": {
        "cvss": 8.8,
        "exploitability_score": 2.8,
        "impact_score": 5.9,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
    },
    "cvss2": null,
    "cpes": [
        {
            "id": 1001075
        },
        {
            "id": 1001076
        },
        {
            "id": 1001077
        },
        {
            "id": 1001078
        },
        {
            "id": 1001080
        },
        {
            "id": 1001081
        },
        {
            "id": 1001082
        },
        {
            "id": 1001083
        },
        {
            "id": 1001084
        },
        {
            "id": 1001085
        },
        {
            "id": 1001086
        },
        {
            "id": 1001087
        },
        {
            "id": 1001088
        },
        {
            "id": 1001089
        },
        {
            "id": 1001090
        },
        {
            "id": 1001091
        },
        {
            "id": 1001092
        },
        {
            "id": 1001093
        },
        {
            "id": 1001094
        },
        {
            "id": 1001095
        },
        {
            "id": 1001096
        },
        {
            "id": 1001097
        },
        {
            "id": 1001098
        },
        {
            "id": 1001099
        },
        {
            "id": 1001100
        },
        {
            "id": 1001101
        },
        {
            "id": 1001102
        },
        {
            "id": 1001103
        },
        {
            "id": 1001104
        },
        {
            "id": 1001105
        },
        {
            "id": 1001106
        },
        {
            "id": 1001107
        },
        {
            "id": 1001108
        },
        {
            "id": 1001109
        },
        {
            "id": 1001110
        },
        {
            "id": 1001111
        },
        {
            "id": 1001112
        },
        {
            "id": 1001113
        },
        {
            "id": 1001114
        },
        {
            "id": 1001115
        },
        {
            "id": 1001116
        },
        {
            "id": 1001117
        },
        {
            "id": 1001118
        },
        {
            "id": 1001119
        },
        {
            "id": 1001120
        },
        {
            "id": 1001121
        },
        {
            "id": 1001122
        },
        {
            "id": 1001123
        },
        {
            "id": 1001124
        },
        {
            "id": 1001125
        },
        {
            "id": 1001126
        },
        {
            "id": 1001127
        },
        {
            "id": 1001128
        },
        {
            "id": 1001129
        },
        {
            "id": 1001130
        },
        {
            "id": 1001131
        },
        {
            "id": 1001132
        },
        {
            "id": 1001133
        },
        {
            "id": 1001134
        },
        {
            "id": 1001135
        },
        {
            "id": 1001136
        },
        {
            "id": 1001137
        },
        {
            "id": 1001138
        },
        {
            "id": 1001139
        },
        {
            "id": 1001140
        },
        {
            "id": 1001141
        },
        {
            "id": 1001142
        },
        {
            "id": 1001143
        },
        {
            "id": 1001144
        },
        {
            "id": 1001145
        },
        {
            "id": 1001146
        },
        {
            "id": 1001147
        },
        {
            "id": 1001148
        },
        {
            "id": 1001149
        },
        {
            "id": 1001150
        },
        {
            "id": 1001151
        },
        {
            "id": 1001152
        },
        {
            "id": 1001153
        },
        {
            "id": 1001154
        },
        {
            "id": 1001155
        },
        {
            "id": 1001156
        },
        {
            "id": 1001157
        },
        {
            "id": 1001158
        },
        {
            "id": 1001159
        },
        {
            "id": 1001160
        },
        {
            "id": 1001161
        },
        {
            "id": 1001162
        },
        {
            "id": 1001163
        },
        {
            "id": 1001164
        },
        {
            "id": 1001165
        },
        {
            "id": 1001166
        },
        {
            "id": 1001167
        },
        {
            "id": 1001168
        },
        {
            "id": 1001169
        },
        {
            "id": 1001170
        },
        {
            "id": 1001171
        },
        {
            "id": 1001172
        },
        {
            "id": 1001173
        },
        {
            "id": 1001174
        },
        {
            "id": 1001175
        },
        {
            "id": 1001176
        },
        {
            "id": 1001177
        },
        {
            "id": 1001178
        },
        {
            "id": 1001179
        },
        {
            "id": 1001180
        },
        {
            "id": 1001181
        },
        {
            "id": 1001182
        },
        {
            "id": 1001183
        },
        {
            "id": 1001184
        },
        {
            "id": 1001185
        },
        {
            "id": 1001186
        },
        {
            "id": 1001187
        },
        {
            "id": 1001188
        },
        {
            "id": 1001189
        },
        {
            "id": 1001190
        },
        {
            "id": 1001191
        },
        {
            "id": 1001192
        },
        {
            "id": 1001193
        },
        {
            "id": 1001194
        },
        {
            "id": 1001195
        },
        {
            "id": 1001196
        },
        {
            "id": 1001197
        },
        {
            "id": 1001198
        },
        {
            "id": 1001199
        },
        {
            "id": 1001200
        },
        {
            "id": 1001201
        },
        {
            "id": 1001202
        },
        {
            "id": 1001203
        },
        {
            "id": 1001204
        },
        {
            "id": 1001205
        },
        {
            "id": 1001206
        },
        {
            "id": 1001207
        },
        {
            "id": 1001208
        },
        {
            "id": 1001209
        },
        {
            "id": 1001210
        },
        {
            "id": 1001211
        },
        {
            "id": 1001212
        },
        {
            "id": 1001213
        },
        {
            "id": 1001214
        },
        {
            "id": 1001215
        },
        {
            "id": 1001216
        },
        {
            "id": 1001217
        },
        {
            "id": 1001218
        },
        {
            "id": 1001219
        },
        {
            "id": 1001220
        },
        {
            "id": 1001221
        },
        {
            "id": 1001222
        },
        {
            "id": 1001223
        },
        {
            "id": 1001224
        },
        {
            "id": 1001225
        },
        {
            "id": 1001226
        },
        {
            "id": 1001227
        },
        {
            "id": 1001228
        },
        {
            "id": 1001229
        },
        {
            "id": 1001230
        },
        {
            "id": 1001231
        },
        {
            "id": 1001232
        },
        {
            "id": 1001233
        },
        {
            "id": 1001234
        },
        {
            "id": 1001235
        },
        {
            "id": 1001236
        },
        {
            "id": 1001237
        },
        {
            "id": 1001238
        },
        {
            "id": 1001239
        },
        {
            "id": 1001240
        },
        {
            "id": 1001241
        },
        {
            "id": 1001242
        },
        {
            "id": 1001243
        },
        {
            "id": 1001244
        },
        {
            "id": 1001245
        },
        {
            "id": 1001246
        },
        {
            "id": 1001247
        },
        {
            "id": 1001248
        },
        {
            "id": 1001249
        },
        {
            "id": 1001250
        },
        {
            "id": 1001251
        },
        {
            "id": 1001252
        },
        {
            "id": 1001253
        },
        {
            "id": 1001254
        },
        {
            "id": 1001255
        },
        {
            "id": 1001256
        },
        {
            "id": 1001257
        },
        {
            "id": 1001258
        },
        {
            "id": 1001259
        },
        {
            "id": 1001260
        },
        {
            "id": 1001261
        },
        {
            "id": 1001262
        },
        {
            "id": 1001263
        },
        {
            "id": 1001264
        },
        {
            "id": 1001265
        },
        {
            "id": 1001266
        },
        {
            "id": 1001267
        },
        {
            "id": 1001268
        },
        {
            "id": 1001269
        },
        {
            "id": 1001270
        },
        {
            "id": 1001271
        },
        {
            "id": 1001272
        },
        {
            "id": 1001273
        },
        {
            "id": 1001274
        },
        {
            "id": 1001275
        },
        {
            "id": 1001276
        },
        {
            "id": 1001277
        },
        {
            "id": 1001278
        },
        {
            "id": 1001279
        },
        {
            "id": 1001280
        },
        {
            "id": 1001281
        },
        {
            "id": 1001282
        },
        {
            "id": 1001283
        },
        {
            "id": 1001284
        },
        {
            "id": 1001285
        },
        {
            "id": 1001286
        },
        {
            "id": 1001287
        },
        {
            "id": 1001288
        },
        {
            "id": 1001289
        },
        {
            "id": 1001290
        },
        {
            "id": 1001291
        },
        {
            "id": 1001292
        },
        {
            "id": 1001293
        },
        {
            "id": 1001294
        },
        {
            "id": 1001295
        },
        {
            "id": 1001296
        },
        {
            "id": 1001297
        },
        {
            "id": 1001298
        },
        {
            "id": 1001299
        },
        {
            "id": 1001300
        },
        {
            "id": 1001301
        },
        {
            "id": 1001302
        },
        {
            "id": 1001303
        },
        {
            "id": 1001304
        },
        {
            "id": 1001305
        },
        {
            "id": 1001306
        },
        {
            "id": 1001307
        },
        {
            "id": 1001308
        },
        {
            "id": 1001309
        },
        {
            "id": 1001310
        },
        {
            "id": 1001311
        },
        {
            "id": 1001312
        },
        {
            "id": 1001313
        },
        {
            "id": 1001314
        },
        {
            "id": 1001315
        },
        {
            "id": 1001316
        },
        {
            "id": 1001317
        },
        {
            "id": 1001318
        },
        {
            "id": 1001319
        },
        {
            "id": 1001320
        },
        {
            "id": 1001321
        },
        {
            "id": 1001322
        },
        {
            "id": 1001323
        },
        {
            "id": 1001324
        },
        {
            "id": 1001325
        },
        {
            "id": 1001326
        },
        {
            "id": 1001327
        },
        {
            "id": 1001328
        },
        {
            "id": 1001329
        },
        {
            "id": 1001330
        },
        {
            "id": 1001331
        },
        {
            "id": 1001332
        },
        {
            "id": 1001333
        },
        {
            "id": 1001334
        },
        {
            "id": 1001335
        },
        {
            "id": 1001336
        },
        {
            "id": 1001337
        },
        {
            "id": 1001338
        },
        {
            "id": 1001339
        },
        {
            "id": 1001340
        },
        {
            "id": 1001341
        },
        {
            "id": 1001342
        },
        {
            "id": 1001343
        },
        {
            "id": 1001344
        },
        {
            "id": 1001345
        },
        {
            "id": 1001346
        },
        {
            "id": 1001347
        },
        {
            "id": 1001348
        },
        {
            "id": 1001349
        },
        {
            "id": 1001350
        },
        {
            "id": 1001351
        },
        {
            "id": 1001352
        },
        {
            "id": 1001353
        },
        {
            "id": 1001354
        },
        {
            "id": 1001355
        },
        {
            "id": 1001356
        },
        {
            "id": 1001357
        },
        {
            "id": 1001358
        },
        {
            "id": 1001359
        },
        {
            "id": 1001360
        },
        {
            "id": 1001361
        }
    ]
}