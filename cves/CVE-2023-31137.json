{
    "id": 214532,
    "name": "CVE-2023-31137",
    "cwe": "CWE-191",
    "modified": "2024-03-07T18:56:58",
    "published": "2023-05-09T12:15:13",
    "status": "Analyzed",
    "summary": "MaraDNS is open-source software that implements the Domain Name System (DNS). In version 3.5.0024 and prior, a remotely exploitable integer underflow vulnerability in the DNS packet decompression function allows an attacker to cause a Denial of Service by triggering an abnormal program termination.\n\nThe vulnerability exists in the `decomp_get_rddata` function within the `Decompress.c` file. When handling a DNS packet with an Answer RR of qtype 16 (TXT record) and any qclass, if the `rdlength` is smaller than `rdata`, the result of the line `Decompress.c:886` is a negative number `len = rdlength - total;`. This value is then passed to the `decomp_append_bytes` function without proper validation, causing the program to attempt to allocate a massive chunk of memory that is impossible to allocate. Consequently, the program exits with an error code of 64, causing a Denial of Service.\n\nOne proposed fix for this vulnerability is to patch `Decompress.c:887` by breaking `if(len <= 0)`, which has been incorporated in version 3.5.0036 via commit bab062bde40b2ae8a91eecd522e84d8b993bab58.",
    "cvss3": {
        "cvss": 7.5,
        "exploitability_score": 3.9,
        "impact_score": 3.6,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    },
    "cvss2": null,
    "cpes": [
        {
            "id": 574528
        },
        {
            "id": 574529
        },
        {
            "id": 574530
        },
        {
            "id": 574531
        },
        {
            "id": 574532
        },
        {
            "id": 574533
        },
        {
            "id": 574534
        },
        {
            "id": 574535
        },
        {
            "id": 574536
        },
        {
            "id": 574537
        },
        {
            "id": 574538
        },
        {
            "id": 574539
        },
        {
            "id": 574540
        },
        {
            "id": 574541
        },
        {
            "id": 574542
        },
        {
            "id": 574543
        },
        {
            "id": 574544
        },
        {
            "id": 574545
        },
        {
            "id": 574546
        },
        {
            "id": 574547
        },
        {
            "id": 574548
        },
        {
            "id": 574549
        },
        {
            "id": 574550
        },
        {
            "id": 574551
        },
        {
            "id": 574552
        },
        {
            "id": 574553
        },
        {
            "id": 574554
        },
        {
            "id": 574555
        },
        {
            "id": 574556
        },
        {
            "id": 574557
        },
        {
            "id": 574558
        },
        {
            "id": 574559
        },
        {
            "id": 574560
        },
        {
            "id": 587080
        },
        {
            "id": 713897
        },
        {
            "id": 885167
        },
        {
            "id": 977967
        },
        {
            "id": 977968
        },
        {
            "id": 977969
        },
        {
            "id": 977970
        },
        {
            "id": 977971
        },
        {
            "id": 977972
        },
        {
            "id": 977973
        },
        {
            "id": 977974
        },
        {
            "id": 977975
        },
        {
            "id": 977976
        },
        {
            "id": 977977
        },
        {
            "id": 977978
        },
        {
            "id": 977979
        },
        {
            "id": 977980
        },
        {
            "id": 977981
        },
        {
            "id": 977982
        },
        {
            "id": 977983
        },
        {
            "id": 977984
        },
        {
            "id": 977985
        },
        {
            "id": 977986
        },
        {
            "id": 977987
        },
        {
            "id": 977988
        },
        {
            "id": 977989
        },
        {
            "id": 977990
        },
        {
            "id": 977991
        },
        {
            "id": 977992
        },
        {
            "id": 977993
        },
        {
            "id": 977994
        },
        {
            "id": 977995
        },
        {
            "id": 977996
        },
        {
            "id": 977997
        },
        {
            "id": 977998
        },
        {
            "id": 977999
        },
        {
            "id": 978000
        },
        {
            "id": 978001
        },
        {
            "id": 978002
        },
        {
            "id": 978003
        },
        {
            "id": 978004
        },
        {
            "id": 978005
        },
        {
            "id": 978006
        },
        {
            "id": 978007
        },
        {
            "id": 978008
        },
        {
            "id": 978009
        },
        {
            "id": 978010
        },
        {
            "id": 978011
        },
        {
            "id": 978012
        },
        {
            "id": 978013
        },
        {
            "id": 978014
        },
        {
            "id": 978015
        },
        {
            "id": 978016
        },
        {
            "id": 978017
        },
        {
            "id": 978018
        },
        {
            "id": 978019
        },
        {
            "id": 978020
        },
        {
            "id": 978021
        },
        {
            "id": 978022
        },
        {
            "id": 1163347
        }
    ]
}